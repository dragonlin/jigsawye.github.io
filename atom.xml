<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>JIGSAWYE</title>
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://jigsawye.com/"/>
  <updated>2016-06-21T04:39:50.000Z</updated>
  <id>http://jigsawye.com/</id>
  
  <author>
    <name>Evan Ye</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>在 OSX 使用 Fish shell 取代 bash/zsh</title>
    <link href="http://jigsawye.com/2016/06/20/install-fish-shell-on-os-x/"/>
    <id>http://jigsawye.com/2016/06/20/install-fish-shell-on-os-x/</id>
    <published>2016-06-20T14:46:22.000Z</published>
    <updated>2016-06-21T04:39:50.000Z</updated>
    
    <content type="html">&lt;p&gt;在 Mac 上用 &lt;a href=&quot;https://github.com/robbyrussell/oh-my-zsh&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;zsh&lt;/a&gt; 已經有一陣子了，最讓我詬病的就是 zsh 的 auto suggestion 及 auto completion 速度相當慢，而且有一些很奇怪的問題（bugs?）。最近 &lt;a href=&quot;https://fishshell.com/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;fish&lt;/a&gt; 這個 shell 好像很紅，索性就把 zsh 換成 fish 了。&lt;/p&gt;
&lt;p&gt;裝完後不只速度 ++，連 plugin / theme 的套件管理都有（&lt;a href=&quot;https://github.com/fisherman/fisherman&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;fisherman&lt;/a&gt;），使用起來相當快速方便，要說缺點呢，就是與 bash 不相容，所以很常在寫 bash 的捧油只能看看囉。&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;blockquote&gt;
&lt;p&gt;Updated on 2016/06/21&lt;br&gt;寫完這篇隔天就收到 oh-my-fish 已經不 maintain 了，所以換成 fisherman。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;fish&quot;&gt;&lt;a href=&quot;#fish&quot; class=&quot;headerlink&quot; title=&quot;fish&quot;&gt;&lt;/a&gt;fish&lt;/h2&gt;&lt;h4 id=&quot;Installation&quot;&gt;&lt;a href=&quot;#Installation&quot; class=&quot;headerlink&quot; title=&quot;Installation&quot;&gt;&lt;/a&gt;Installation&lt;/h4&gt;&lt;p&gt;只要用 homebrew 安裝即可：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ brew install fish&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&quot;Usage&quot;&gt;&lt;a href=&quot;#Usage&quot; class=&quot;headerlink&quot; title=&quot;Usage&quot;&gt;&lt;/a&gt;Usage&lt;/h4&gt;&lt;p&gt;不論你預設是 bash 還是 zsh，執行 &lt;code&gt;fish&lt;/code&gt; 就能切到 fish shell 了。&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ fish&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&quot;Set-fish-as-default-shell&quot;&gt;&lt;a href=&quot;#Set-fish-as-default-shell&quot; class=&quot;headerlink&quot; title=&quot;Set fish as default shell&quot;&gt;&lt;/a&gt;Set fish as default shell&lt;/h4&gt;&lt;p&gt;當然不可能每次開 terminal 就切換一次，我們可以把 fish 改成 terminal 的 default shell：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ &lt;span class=&quot;built_in&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;/usr/local/bin/fish&quot;&lt;/span&gt; | sudo tee &lt;span class=&quot;_&quot;&gt;-a&lt;/span&gt; /etc/shells&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ chsh &lt;span class=&quot;_&quot;&gt;-s&lt;/span&gt; /usr/&lt;span class=&quot;built_in&quot;&gt;local&lt;/span&gt;/bin/fish&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;fisherman&quot;&gt;&lt;a href=&quot;#fisherman&quot; class=&quot;headerlink&quot; title=&quot;fisherman&quot;&gt;&lt;/a&gt;fisherman&lt;/h2&gt;&lt;p&gt;&lt;code&gt;fisherman&lt;/code&gt; 跟 &lt;code&gt;oh-my-zsh&lt;/code&gt; 用起來是截然不同的感受，oh-my-zsh 是把 plugins 全部都裝好了，只需要啟動，fishermane 用起來則像是 &lt;code&gt;npm&lt;/code&gt; 或 &lt;code&gt;composer&lt;/code&gt; 的套件管理器一樣。&lt;/p&gt;
&lt;h4 id=&quot;Installation-1&quot;&gt;&lt;a href=&quot;#Installation-1&quot; class=&quot;headerlink&quot; title=&quot;Installation&quot;&gt;&lt;/a&gt;Installation&lt;/h4&gt;&lt;p&gt;curl 拉下來就行了：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ curl -Lo ~/.config/fish/&lt;span class=&quot;built_in&quot;&gt;functions&lt;/span&gt;/fisher.fish --create-dirs git.io/fisher&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&quot;Usage-1&quot;&gt;&lt;a href=&quot;#Usage-1&quot; class=&quot;headerlink&quot; title=&quot;Usage&quot;&gt;&lt;/a&gt;Usage&lt;/h4&gt;&lt;p&gt;直接看官方 README 吧：&lt;a href=&quot;https://github.com/fisherman/fisherman&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://github.com/fisherman/fisherman&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;額外補充&quot;&gt;&lt;a href=&quot;#額外補充&quot; class=&quot;headerlink&quot; title=&quot;額外補充&quot;&gt;&lt;/a&gt;額外補充&lt;/h2&gt;&lt;p&gt;如果你有在使用 nvm 的話，因為 nvm 是透過 &lt;code&gt;source ~/.nvm/nvm.sh&lt;/code&gt; 執行，但因為 fish 不支援 bash，所以這支檔案裡的 shell 會直接爆給你看。&lt;/p&gt;
&lt;p&gt;要解決這個問題的話直接透過 fisherman 安裝 nvm 的 &lt;a href=&quot;https://github.com/fisherman/nvm&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;plugin&lt;/a&gt; 即可：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ fisher nvm&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;這樣還會發生一個問題，就是 nvm 不會自動使用 default 的 node 版本：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ node -v&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;fish: Unknown &lt;span class=&quot;built_in&quot;&gt;command&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;node&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;用編輯器打開 &lt;code&gt;~/.config/fish/config.fish&lt;/code&gt; 新增下面這行即可：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;bass &lt;span class=&quot;built_in&quot;&gt;source&lt;/span&gt; ~/.nvm/nvm.sh&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;bass 是讓 fish 可以執行 bash 的一個橋接工具，透過 bass 就能執行 bash 了。&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;在 Mac 上用 &lt;a href=&quot;https://github.com/robbyrussell/oh-my-zsh&quot;&gt;zsh&lt;/a&gt; 已經有一陣子了，最讓我詬病的就是 zsh 的 auto suggestion 及 auto completion 速度相當慢，而且有一些很奇怪的問題（bugs?）。最近 &lt;a href=&quot;https://fishshell.com/&quot;&gt;fish&lt;/a&gt; 這個 shell 好像很紅，索性就把 zsh 換成 fish 了。&lt;/p&gt;
&lt;p&gt;裝完後不只速度 ++，連 plugin / theme 的套件管理都有（&lt;a href=&quot;https://github.com/fisherman/fisherman&quot;&gt;fisherman&lt;/a&gt;），使用起來相當快速方便，要說缺點呢，就是與 bash 不相容，所以很常在寫 bash 的捧油只能看看囉。&lt;/p&gt;
    
    </summary>
    
      <category term="-note" scheme="http://jigsawye.com/categories/note/"/>
    
    
      <category term="-terminal" scheme="http://jigsawye.com/tags/terminal/"/>
    
  </entry>
  
  <entry>
    <title>告別 JavaScript 的 Promise！迎接 Async/Await 的到來</title>
    <link href="http://jigsawye.com/2016/04/18/understanding-javascript-async-await/"/>
    <id>http://jigsawye.com/2016/04/18/understanding-javascript-async-await/</id>
    <published>2016-04-18T11:33:55.000Z</published>
    <updated>2016-04-19T12:37:59.000Z</updated>
    
    <content type="html">&lt;p&gt;最近在做一個自己的 &lt;a href=&quot;https://github.com/jigsawye/koa2-boilerplate&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;API boilerplate&lt;/a&gt;，選用了 &lt;a href=&quot;https://github.com/koajs/koa&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;koa&lt;/a&gt; 這個 library。而其中除了 stable 的 &lt;code&gt;1.x&lt;/code&gt; 外，它還 release &lt;code&gt;2.x&lt;/code&gt;！有什麼不同呢？&lt;code&gt;1.x&lt;/code&gt; 是用 generator 來實作，而到了 &lt;code&gt;2.x&lt;/code&gt; 竟然是用 Async/Await！身為一個熱血碼農，怎能錯過這個進場 Async/Await 的大好機會 XD。&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h2 id=&quot;說說-Promise&quot;&gt;&lt;a href=&quot;#說說-Promise&quot; class=&quot;headerlink&quot; title=&quot;說說 Promise&quot;&gt;&lt;/a&gt;說說 Promise&lt;/h2&gt;&lt;p&gt;在很久以前，那是個 JavaScript callback hell 的年代，為了處理這種處境，有人提出了 Promise 的寫法。而 Promise 也是近年開發 JavaScript 程式不可或缺的一門基礎，在 ES2015 也將 Promise 納為其中的一項標準。&lt;/p&gt;
&lt;h4 id=&quot;非同步-function&quot;&gt;&lt;a href=&quot;#非同步-function&quot; class=&quot;headerlink&quot; title=&quot;非同步 function&quot;&gt;&lt;/a&gt;非同步 function&lt;/h4&gt;&lt;p&gt;關於非同步的文章網路上已經很多了，就不在此贅述。在這裡我直接先以 Promise 實作一個簡易的非同步程式：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; posts = [&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#123; title: &lt;span class=&quot;string&quot;&gt;&#39;Post 1&#39;&lt;/span&gt;, content: &lt;span class=&quot;string&quot;&gt;&#39;fake content&#39;&lt;/span&gt;&amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#123; title: &lt;span class=&quot;string&quot;&gt;&#39;Post 2&#39;&lt;/span&gt;, content: &lt;span class=&quot;string&quot;&gt;&#39;fake content&#39;&lt;/span&gt;&amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; getPosts = () =&amp;gt; &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;Promise&lt;/span&gt;(resolve =&amp;gt; setTimeout(() =&amp;gt; resolve(posts), &lt;span class=&quot;number&quot;&gt;1000&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;我習慣寫 ES2015 的 arrow function，如果看不習慣的話，在一般 function 會像下面這樣：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;getPosts&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;Promise&lt;/span&gt;(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;resolve&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    setTimeout(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      resolve(posts);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125; , &lt;span class=&quot;number&quot;&gt;3000&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;這支程式會回傳一個 Promise，而模擬在 1 秒後 resolve 一個模擬的 &lt;code&gt;posts&lt;/code&gt;。&lt;/p&gt;
&lt;h4 id=&quot;呼叫一個非同步-function&quot;&gt;&lt;a href=&quot;#呼叫一個非同步-function&quot; class=&quot;headerlink&quot; title=&quot;呼叫一個非同步 function&quot;&gt;&lt;/a&gt;呼叫一個非同步 function&lt;/h4&gt;&lt;p&gt;在 Promise 的做法中，我們就會這樣來實作取得 posts 的程式：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; printPostsToConsole = () =&amp;gt; getPosts().then(posts =&amp;gt; &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(posts));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;printPostsToConsole();&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;除此之外還會加上 error handler：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; printPostsToConsole = () =&amp;gt; getPosts()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  .then(posts =&amp;gt; &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(posts))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  .catch(err =&amp;gt; &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(err));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;printPostsToConsole();&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;如果是-Async-Await？&quot;&gt;&lt;a href=&quot;#如果是-Async-Await？&quot; class=&quot;headerlink&quot; title=&quot;如果是 Async/Await？&quot;&gt;&lt;/a&gt;如果是 Async/Await？&lt;/h2&gt;&lt;p&gt;Async/Await 被規範在 ES2016 的標準中，很多的討論都指向 Async/Await 會是非同步的終極解決方案。&lt;/p&gt;
&lt;h4 id=&quot;用-Async-Await-處理非同步-function&quot;&gt;&lt;a href=&quot;#用-Async-Await-處理非同步-function&quot; class=&quot;headerlink&quot; title=&quot;用 Async/Await 處理非同步 function&quot;&gt;&lt;/a&gt;用 Async/Await 處理非同步 function&lt;/h4&gt;&lt;p&gt;換成 Async/Await 的話，就不必寫下 &lt;code&gt;.then()&lt;/code&gt; 了！就像同步的程式一般，不必理會它是否為非同步。&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; printPostsToConsole = &lt;span class=&quot;keyword&quot;&gt;async&lt;/span&gt; () =&amp;gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; posts = &lt;span class=&quot;keyword&quot;&gt;await&lt;/span&gt; getPosts();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(posts);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;printPostsToConsole();&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;也可以寫成這樣：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;printPostsToConsole&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; posts = &lt;span class=&quot;keyword&quot;&gt;await&lt;/span&gt; getPosts();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(posts);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;printPostsToConsole();&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;宣告在 &lt;code&gt;printPostsToConsole&lt;/code&gt; 的 &lt;code&gt;async&lt;/code&gt; 表示該 function 是個非同步的。而在 function 內 &lt;code&gt;getPosts&lt;/code&gt; 之前的 &lt;code&gt;await&lt;/code&gt; 表示要等待這個非同步的結果回傳後才會繼續執行，也就是說這個 function 內的程式都變為同步了！&lt;/p&gt;
&lt;p&gt;當然在也要加上 error handler。在 Async/Await 中請使用 &lt;code&gt;try/catch&lt;/code&gt;：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; printPostsToConsole = &lt;span class=&quot;keyword&quot;&gt;async&lt;/span&gt; () =&amp;gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;try&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; posts = &lt;span class=&quot;keyword&quot;&gt;await&lt;/span&gt; getPosts();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(posts);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125; &lt;span class=&quot;keyword&quot;&gt;catch&lt;/span&gt;(err) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(err);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;現在就開始用-Async-Await！&quot;&gt;&lt;a href=&quot;#現在就開始用-Async-Await！&quot; class=&quot;headerlink&quot; title=&quot;現在就開始用 Async/Await！&quot;&gt;&lt;/a&gt;現在就開始用 Async/Await！&lt;/h2&gt;&lt;h4 id=&quot;在前端&quot;&gt;&lt;a href=&quot;#在前端&quot; class=&quot;headerlink&quot; title=&quot;在前端&quot;&gt;&lt;/a&gt;在前端&lt;/h4&gt;&lt;p&gt;如何在現在的環境實作 Async/Await 呢？其實如果有在寫 Front-end（尤其是 React），基本上應該已經使用了 &lt;a href=&quot;babeljs.io&quot;&gt;babel&lt;/a&gt;。如果要使用 Async/Await，presets 除了原本的 &lt;code&gt;es2015&lt;/code&gt; 外，只要加上 &lt;code&gt;stage-3&lt;/code&gt;：&lt;/p&gt;
&lt;figure class=&quot;highlight json&quot;&gt;&lt;figcaption&gt;&lt;span&gt;.bebalrc&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;&quot;presets&quot;&lt;/span&gt;: [&lt;span class=&quot;string&quot;&gt;&quot;es2015&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;stage-3&quot;&lt;/span&gt;]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;或是將 &lt;code&gt;transform-async-to-generator&lt;/code&gt; 加入 plugins 就行了：&lt;/p&gt;
&lt;figure class=&quot;highlight json&quot;&gt;&lt;figcaption&gt;&lt;span&gt;.bebalrc&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;&quot;presets&quot;&lt;/span&gt;: [&lt;span class=&quot;string&quot;&gt;&quot;es2015&quot;&lt;/span&gt;],&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;&quot;plugins&quot;&lt;/span&gt;: [&lt;span class=&quot;string&quot;&gt;&quot;transform-async-to-generator&quot;&lt;/span&gt;]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&quot;在後端&quot;&gt;&lt;a href=&quot;#在後端&quot; class=&quot;headerlink&quot; title=&quot;在後端&quot;&gt;&lt;/a&gt;在後端&lt;/h4&gt;&lt;p&gt;在 backend 的情況則比較不同，雖然一樣要透過 babel，不過請裝 &lt;a href=&quot;babel-preset-es2015-node4&quot;&gt;es2015-node4&lt;/a&gt; 或是 &lt;a href=&quot;https://github.com/alekseykulikov/babel-preset-es2015-node5&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;es2015-node5&lt;/a&gt;（根據你的 node 版本做選擇），其餘則跟前端一樣。&lt;/p&gt;
&lt;p&gt;接著如果要讓你的程式能夠執行 Async/Await，請額外建立一個檔案，並 require &lt;code&gt;babel-register&lt;/code&gt; 及你程式的 entry：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;figcaption&gt;&lt;span&gt;index.js&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;babel-register&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;../app.js&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;接著只要用 node 執行 &lt;code&gt;index.js&lt;/code&gt; 就行了。&lt;/p&gt;
&lt;p&gt;關於詳細的設定可以參考我的 &lt;a href=&quot;https://github.com/jigsawye/koa2-boilerplate&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;koa2-boilerplate&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;後記&quot;&gt;&lt;a href=&quot;#後記&quot; class=&quot;headerlink&quot; title=&quot;後記&quot;&gt;&lt;/a&gt;後記&lt;/h2&gt;&lt;p&gt;緊接在 ES2015 之後的 ES2016 也增加了不少的新 feature，除了 Async/Await 也有 &lt;a href=&quot;https://github.com/sebmarkbage/ecmascript-rest-spread&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;object-rest-spread&lt;/a&gt;、&lt;a href=&quot;https://github.com/tc39/ecma262/blob/master/workingdocs/callconstructor.md&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;class-constructor-call&lt;/a&gt;、&lt;a href=&quot;https://github.com/jeffmo/es-class-fields-and-static-properties&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;class-properties&lt;/a&gt;等等。&lt;/p&gt;
&lt;p&gt;在 ES2015 泛用的現在，其實有機會的話可以慢慢接觸 ES2016 的功能了，對開發可以增添一股助力！&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;最近在做一個自己的 &lt;a href=&quot;https://github.com/jigsawye/koa2-boilerplate&quot;&gt;API boilerplate&lt;/a&gt;，選用了 &lt;a href=&quot;https://github.com/koajs/koa&quot;&gt;koa&lt;/a&gt; 這個 library。而其中除了 stable 的 &lt;code&gt;1.x&lt;/code&gt; 外，它還 release &lt;code&gt;2.x&lt;/code&gt;！有什麼不同呢？&lt;code&gt;1.x&lt;/code&gt; 是用 generator 來實作，而到了 &lt;code&gt;2.x&lt;/code&gt; 竟然是用 Async/Await！身為一個熱血碼農，怎能錯過這個進場 Async/Await 的大好機會 XD。&lt;/p&gt;
    
    </summary>
    
      <category term="tutorial" scheme="http://jigsawye.com/categories/tutorial/"/>
    
    
      <category term="nodejs" scheme="http://jigsawye.com/tags/nodejs/"/>
    
      <category term="javascript" scheme="http://jigsawye.com/tags/javascript/"/>
    
      <category term="es2015" scheme="http://jigsawye.com/tags/es2015/"/>
    
      <category term="es2016" scheme="http://jigsawye.com/tags/es2016/"/>
    
  </entry>
  
  <entry>
    <title>在 OSX 使用 Homebrew 打造精巧的 Laravel 開發環境</title>
    <link href="http://jigsawye.com/2016/02/01/setup-laravel-development-environment-with-homebrew/"/>
    <id>http://jigsawye.com/2016/02/01/setup-laravel-development-environment-with-homebrew/</id>
    <published>2016-02-01T09:08:14.000Z</published>
    <updated>2016-02-03T11:16:29.000Z</updated>
    
    <content type="html">&lt;div class=&quot;tip&quot;&gt;&lt;br&gt;建議你熟悉 Terminal 的操作再參考本篇，否則容易把系統環境搞亂。&lt;br&gt;&lt;/div&gt;

&lt;p&gt;在開發 Laravel Application 時，新手可能使用 *AMP 的系統環境整合包，而大多數人會選擇官方所提供的 &lt;a href=&quot;https://laravel.tw/docs/5.2/homestead&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Homestead&lt;/a&gt;。但 Homestead 其實就是一包很大包的虛擬機再配上 Vargrant，曾幾何時我也是使用 Homestead，但是因為我的小 Macbook Air 實在是受不了虛擬機容量一大包，又吃一堆記憶體。&lt;/p&gt;
&lt;p&gt;雖然標題是寫 Laravel，但是要應用在其他的 PHP Application 也是可行的。本篇就以 Homebrew 為主軸，打造 Laravel 的開發環境。&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h2 id=&quot;啥？Homebrew&quot;&gt;&lt;a href=&quot;#啥？Homebrew&quot; class=&quot;headerlink&quot; title=&quot;啥？Homebrew&quot;&gt;&lt;/a&gt;啥？Homebrew&lt;/h2&gt;&lt;p&gt;如同 ubuntu 有 &lt;code&gt;apt-get&lt;/code&gt;、CentOS 有 &lt;code&gt;yum&lt;/code&gt; 一樣，&lt;a href=&quot;http://brew.sh/index_zh-tw.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Homebrew&lt;/a&gt; 就是 OSX 的套件管理器。不同的是前者都是系統內建的，而 Homebrew 則是因為 OSX 本身沒有這種東西，所以就有大神為 OSX 打造了套件管理器。&lt;/p&gt;
&lt;h2 id=&quot;需要什麼？&quot;&gt;&lt;a href=&quot;#需要什麼？&quot; class=&quot;headerlink&quot; title=&quot;需要什麼？&quot;&gt;&lt;/a&gt;需要什麼？&lt;/h2&gt;&lt;p&gt;在開始之前，先說說開發 Laravel 需要哪些需求？&lt;/p&gt;
&lt;h3 id=&quot;PHP-CLI&quot;&gt;&lt;a href=&quot;#PHP-CLI&quot; class=&quot;headerlink&quot; title=&quot;PHP-CLI&quot;&gt;&lt;/a&gt;PHP-CLI&lt;/h3&gt;&lt;p&gt;Laravel 是目前在 PHP 中最熱門的 Framework，其實除了透過 *AMP 指向 &lt;code&gt;public&lt;/code&gt; 資料夾及使用 Homestead 外，Laravel 也提供了 command line 的方式啟動 development server。&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ php artisan serve&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Laravel development server started on http://localhost:8000/&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;只要在專案目錄中執行 &lt;code&gt;php artisan serve&lt;/code&gt;，就會執行 development server。也就是說我們至少需要 php-cli 來執行 development server。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;PHP-CLI 為 PHP Command Line Interface，也就是 Command Line 的 PHP 執行環境。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;MariaDB&quot;&gt;&lt;a href=&quot;#MariaDB&quot; class=&quot;headerlink&quot; title=&quot;MariaDB&quot;&gt;&lt;/a&gt;MariaDB&lt;/h3&gt;&lt;p&gt;沒錯，開發一個 Web Application 一定需要資料庫，而我平常是使用 MariaDB，所以我們也必須安裝 MariaDB。&lt;/p&gt;
&lt;h3 id=&quot;Redis&quot;&gt;&lt;a href=&quot;#Redis&quot; class=&quot;headerlink&quot; title=&quot;Redis&quot;&gt;&lt;/a&gt;Redis&lt;/h3&gt;&lt;p&gt;而我平常在開發的時候，會把 Cache、Session、及 Queue 的 Driver 都設定為 Redis，所以我們會安裝 Redis。&lt;/p&gt;
&lt;h3 id=&quot;總結&quot;&gt;&lt;a href=&quot;#總結&quot; class=&quot;headerlink&quot; title=&quot;總結&quot;&gt;&lt;/a&gt;總結&lt;/h3&gt;&lt;p&gt;所以我們必須透過 Homebrew 安裝這些東西：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;php&lt;/li&gt;
&lt;li&gt;mariadb&lt;/li&gt;
&lt;li&gt;redis&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;Getting-started&quot;&gt;&lt;a href=&quot;#Getting-started&quot; class=&quot;headerlink&quot; title=&quot;Getting started&quot;&gt;&lt;/a&gt;Getting started&lt;/h2&gt;&lt;h3 id=&quot;Homebrew&quot;&gt;&lt;a href=&quot;#Homebrew&quot; class=&quot;headerlink&quot; title=&quot;Homebrew&quot;&gt;&lt;/a&gt;Homebrew&lt;/h3&gt;&lt;h4 id=&quot;安裝&quot;&gt;&lt;a href=&quot;#安裝&quot; class=&quot;headerlink&quot; title=&quot;安裝&quot;&gt;&lt;/a&gt;安裝&lt;/h4&gt;&lt;p&gt;開始之前，當然必須先安裝 &lt;a href=&quot;http://brew.sh/index_zh-tw.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Homebrew&lt;/a&gt;，官方網站已有提供指令進行安裝，打開 terminal 並輸入即可：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;/usr/bin/ruby &lt;span class=&quot;_&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;variable&quot;&gt;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)&lt;/span&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;此指令會透過 curl 下載官方安裝檔，並透過 ruby 執行。他會在你的電腦安裝 homebrew。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&quot;使用&quot;&gt;&lt;a href=&quot;#使用&quot; class=&quot;headerlink&quot; title=&quot;使用&quot;&gt;&lt;/a&gt;使用&lt;/h4&gt;&lt;p&gt;Homebrew 的使用方式很簡單，以下介紹幾個常用指令：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;brew update&lt;/code&gt;：更新 Homebrew。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;brew search wget&lt;/code&gt;：透過 &lt;code&gt;brew search&lt;/code&gt; 可以搜尋套件，範例為搜尋名字有 wget 的套件。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;brew install wget&lt;/code&gt;：你可以使用 &lt;code&gt;brew intsall&lt;/code&gt; 來安裝套件，範例會安裝 wget。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;更多指令可以輸入 &lt;code&gt;brew help&lt;/code&gt;，或參考&lt;a href=&quot;https://github.com/Homebrew/homebrew/blob/master/share/doc/homebrew/FAQ.md&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;官方的 FAQ&lt;/a&gt;。&lt;/p&gt;
&lt;h3 id=&quot;PHP&quot;&gt;&lt;a href=&quot;#PHP&quot; class=&quot;headerlink&quot; title=&quot;PHP&quot;&gt;&lt;/a&gt;PHP&lt;/h3&gt;&lt;h4 id=&quot;安裝-1&quot;&gt;&lt;a href=&quot;#安裝-1&quot; class=&quot;headerlink&quot; title=&quot;安裝&quot;&gt;&lt;/a&gt;安裝&lt;/h4&gt;&lt;p&gt;當然，我們首先必須安裝 PHP，我們先執行以下指令尋找 php：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ brew search php&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;你應該會看到非常多的 php，像是 &lt;code&gt;homebrew/php/php53&lt;/code&gt;、&lt;code&gt;homebrew/php/php54&lt;/code&gt;⋯⋯一直到最新的 &lt;code&gt;homebrew/php/php70&lt;/code&gt;。而 php 7.0 有相容舊版本，所以我是使用 php 7.0 開發，所以我們來搜尋一下 php 7.0：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ brew search php70&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;你會看到 PHP 7.0，及 PHP 7.0 的 extenstions。我們直接安裝 php70 即可：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ brew install php70&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&quot;使用-1&quot;&gt;&lt;a href=&quot;#使用-1&quot; class=&quot;headerlink&quot; title=&quot;使用&quot;&gt;&lt;/a&gt;使用&lt;/h4&gt;&lt;p&gt;安裝完後，執行以下指令看看是否有安裝完成：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ php -v&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;PHP 7.0.2 (cli) (built: Jan  7 2016 10:40:26) ( NTS )&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Copyright (c) 1997-2015 The PHP Group&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Zend Engine v3.0.0, Copyright (c) 1998-2015 Zend Technologies&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;你可以進入一個 Laravel 專案，並執行 development server 看看：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ laravel new awesome_homebrew&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ &lt;span class=&quot;built_in&quot;&gt;cd&lt;/span&gt; awesome_homebrew&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ php artisan serve&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Laravel development server started on http://localhost:8000/&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;你也可以指定 Port：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ php artisan serve --port=8080&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Laravel development server started on http://localhost:8080/&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;如果是一般的 PHP 專案，可以用以下方式開啟 development server：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ php -S localhost:8000 -t public&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;PHP 7.0.2 Development Server started at Mon Feb  1 17:02:58 2016&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Listening on http://localhost:8000&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Document root is /Users/jigsawye/Projects/laravel/demo/public&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Press Ctrl-C to quit.&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;其中 &lt;code&gt;localhost:8000&lt;/code&gt; 的部分是指你要開在哪個 Host，後面的 public 則是選擇你 &lt;code&gt;indxe.php&lt;/code&gt; 的目錄，也就是 Application 進入點。&lt;/p&gt;
&lt;h3 id=&quot;MariaDB-1&quot;&gt;&lt;a href=&quot;#MariaDB-1&quot; class=&quot;headerlink&quot; title=&quot;MariaDB&quot;&gt;&lt;/a&gt;MariaDB&lt;/h3&gt;&lt;h4 id=&quot;安裝-2&quot;&gt;&lt;a href=&quot;#安裝-2&quot; class=&quot;headerlink&quot; title=&quot;安裝&quot;&gt;&lt;/a&gt;安裝&lt;/h4&gt;&lt;p&gt;安裝方式一樣，先搜尋再安裝：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ brew search mariadb&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ brew install mariadb&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&quot;使用-2&quot;&gt;&lt;a href=&quot;#使用-2&quot; class=&quot;headerlink&quot; title=&quot;使用&quot;&gt;&lt;/a&gt;使用&lt;/h4&gt;&lt;p&gt;安裝完成後，Homebrew 會提示你可以使用以下指令開啟 MySQL：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ mysql.server start&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Starting MySQL&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;. SUCCESS!&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;然後你可以連接至你的 MySQL：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ mysql -uroot&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;Redis-1&quot;&gt;&lt;a href=&quot;#Redis-1&quot; class=&quot;headerlink&quot; title=&quot;Redis&quot;&gt;&lt;/a&gt;Redis&lt;/h3&gt;&lt;h4 id=&quot;安裝-3&quot;&gt;&lt;a href=&quot;#安裝-3&quot; class=&quot;headerlink&quot; title=&quot;安裝&quot;&gt;&lt;/a&gt;安裝&lt;/h4&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ brew search redis&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ brew install redis&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&quot;使用-3&quot;&gt;&lt;a href=&quot;#使用-3&quot; class=&quot;headerlink&quot; title=&quot;使用&quot;&gt;&lt;/a&gt;使用&lt;/h4&gt;&lt;p&gt;同樣的，Homebrew 提示使用以下指令開啟 Redis：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ redis-server /usr/&lt;span class=&quot;built_in&quot;&gt;local&lt;/span&gt;/etc/redis.conf&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5725:M 01 Feb 15:53:36.291 * Increased maximum number of open files to 10032 (it was originally &lt;span class=&quot;built_in&quot;&gt;set&lt;/span&gt; to 2560).&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                _._&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;           _.-``__ &lt;span class=&quot;string&quot;&gt;&#39;&#39;&lt;/span&gt;-._&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      _.-``    `.  `_.  &lt;span class=&quot;string&quot;&gt;&#39;&#39;&lt;/span&gt;-._           Redis 3.0.7 (00000000/0) 64 bit&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  .-`` .-```.  ```\/    _.,_ &lt;span class=&quot;string&quot;&gt;&#39;&#39;&lt;/span&gt;-._&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; (    &lt;span class=&quot;string&quot;&gt;&#39;      ,       .-`  | `,    )     Running in standalone mode&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; |`-._`-...-` __...-.``-._|&#39;&lt;/span&gt;` _.-&lt;span class=&quot;string&quot;&gt;&#39;|     Port: 6379&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; |    `-._   `._    /     _.-&#39;&lt;/span&gt;    |     PID: 5725&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  `-._    `-._  `-./  _.-&lt;span class=&quot;string&quot;&gt;&#39;    _.-&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; |`-._`-._    `-.__.-&lt;span class=&quot;string&quot;&gt;&#39;    _.-&#39;&lt;/span&gt;_.-&lt;span class=&quot;string&quot;&gt;&#39;|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; |    `-._`-._        _.-&#39;&lt;/span&gt;_.-&lt;span class=&quot;string&quot;&gt;&#39;    |           http://redis.io&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  `-._    `-._`-.__.-&#39;&lt;/span&gt;_.-&lt;span class=&quot;string&quot;&gt;&#39;    _.-&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; |`-._`-._    `-.__.-&lt;span class=&quot;string&quot;&gt;&#39;    _.-&#39;&lt;/span&gt;_.-&lt;span class=&quot;string&quot;&gt;&#39;|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; |    `-._`-._        _.-&#39;&lt;/span&gt;_.-&lt;span class=&quot;string&quot;&gt;&#39;    |&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  `-._    `-._`-.__.-&#39;&lt;/span&gt;_.-&lt;span class=&quot;string&quot;&gt;&#39;    _.-&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      `-._    `-.__.-&lt;span class=&quot;string&quot;&gt;&#39;    _.-&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          `-._        _.-&lt;span class=&quot;string&quot;&gt;&#39;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;              `-.__.-&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5725:M 01 Feb 15:53:36.293 &lt;span class=&quot;comment&quot;&gt;# Server started, Redis version 3.0.7&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5725:M 01 Feb 15:53:36.293 * DB loaded from disk: 0.000 seconds&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5725:M 01 Feb 15:53:36.293 * The server is now ready to accept connections on port 6379&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;不過你會發現，Redis 會佔用一個 terminal，相當不便。&lt;/p&gt;
&lt;h3 id=&quot;Homebrew-Services&quot;&gt;&lt;a href=&quot;#Homebrew-Services&quot; class=&quot;headerlink&quot; title=&quot;Homebrew Services&quot;&gt;&lt;/a&gt;Homebrew Services&lt;/h3&gt;&lt;p&gt;相信有些人可能會發現，在啟動 MariaDB 及 Redis 時，指令有些微的不同，沒有一個統一管理這些 services 的工具，像是 ubuntu 的 &lt;code&gt;service &amp;lt;servicename&amp;gt; start&lt;/code&gt;。雖然 Homebrew 有提供 &lt;code&gt;launchctl&lt;/code&gt; 來管理，不過操作起來實在是太麻煩了。其實 Homebrew 額外有提供一個 services 的管理工具，透過這個工具就可以統一管理所有的 services。&lt;/p&gt;
&lt;h4 id=&quot;安裝-4&quot;&gt;&lt;a href=&quot;#安裝-4&quot; class=&quot;headerlink&quot; title=&quot;安裝&quot;&gt;&lt;/a&gt;安裝&lt;/h4&gt;&lt;p&gt;執行以下指令安裝：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ brew tap homebrew/services&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;如果你剛剛有透過指令啟動 MariaDB 與 Redis，現在我們先將它關閉。Redis 直接透過 &lt;code&gt;Ctrl + C&lt;/code&gt; 關閉即可，MariaDB 請使用以下指令關閉：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ mysql.server stop&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Shutting down MySQL&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;... SUCCESS!&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;`&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&quot;使用-4&quot;&gt;&lt;a href=&quot;#使用-4&quot; class=&quot;headerlink&quot; title=&quot;使用&quot;&gt;&lt;/a&gt;使用&lt;/h4&gt;&lt;p&gt;使用以下指令可以查看目前所安裝的 services：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ brew services list&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Name    Status  User Plist&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mariadb stopped&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;php70   stopped&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;redis   stopped&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;很方便吧！接著我們來啟動 MariaDB 及 Redis：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ brew services start mariadb&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;==&amp;gt; Successfully started `mariadb` (label: homebrew.mxcl.mariadb)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ brew services start redis&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;==&amp;gt; Successfully started `redis` (label: homebrew.mxcl.redis)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;查看一下啟用之後的 services 列表：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ brew sercies list&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Name    Status  User     Plist&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mariadb started jigsawye /Users/jigsawye/Library/LaunchAgents/homebrew.mxcl.mariadb.plist&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;php70   stopped&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;redis   started jigsawye /Users/jigsawye/Library/LaunchAgents/homebrew.mxcl.redis.plist&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;若要關閉 servies，執行 &lt;code&gt;brew services stop &amp;lt;servicename&amp;gt;&lt;/code&gt; 即可！&lt;/p&gt;
&lt;h2 id=&quot;額外補充&quot;&gt;&lt;a href=&quot;#額外補充&quot; class=&quot;headerlink&quot; title=&quot;額外補充&quot;&gt;&lt;/a&gt;額外補充&lt;/h2&gt;&lt;h3 id=&quot;多版本-PHP-切換&quot;&gt;&lt;a href=&quot;#多版本-PHP-切換&quot; class=&quot;headerlink&quot; title=&quot;多版本 PHP 切換&quot;&gt;&lt;/a&gt;多版本 PHP 切換&lt;/h3&gt;&lt;p&gt;在一些專案可能需不同的 PHP 版本來執行，以下就說明如何接換多版本的 PHP。&lt;/p&gt;
&lt;h4 id=&quot;安裝其他版本的-PHP&quot;&gt;&lt;a href=&quot;#安裝其他版本的-PHP&quot; class=&quot;headerlink&quot; title=&quot;安裝其他版本的 PHP&quot;&gt;&lt;/a&gt;安裝其他版本的 PHP&lt;/h4&gt;&lt;p&gt;像前面說明的一樣，我們可以直接安裝其他版本的 PHP：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ brew install php56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Error: Cannot install homebrew/php/php56 because conflicting formulae are installed.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  php70: because different php versions install the same binaries.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Please `brew unlink php70` before continuing.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Unlinking removes a formula&lt;span class=&quot;string&quot;&gt;&#39;s symlinks from /usr/local. You can&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;link the formula again after the install finishes. You can --force this&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;install, but the build may fail or cause obscure side-effects in the&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;resulting software.&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;你應該看到這個錯誤，他的意思是指你已經安裝了其他版本的 PHP，請 &lt;code&gt;unlink&lt;/code&gt; 其他版本後再安裝。&lt;code&gt;unlink&lt;/code&gt; 意指你必須將原本綁的 &lt;code&gt;php70&lt;/code&gt; 給卸除掉（並非移除），再接著安裝。&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ brew unlink php70&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ brew install php56&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;接著就可以查看 PHP 版本，你應該切換成 PHP 5.6：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ php -v&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;PHP 5.6.17 (cli) (built: Jan  8 2016 10:27:48)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Copyright (c) 1997-2015 The PHP Group&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Zend Engine v2.6.0, Copyright (c) 1998-2015 Zend Technologies&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&quot;切換回-PHP-7-0&quot;&gt;&lt;a href=&quot;#切換回-PHP-7-0&quot; class=&quot;headerlink&quot; title=&quot;切換回 PHP 7.0&quot;&gt;&lt;/a&gt;切換回 PHP 7.0&lt;/h4&gt;&lt;p&gt;若要切換回去也相當簡單，&lt;code&gt;unlink&lt;/code&gt; PHP 5.6 再 &lt;code&gt;link&lt;/code&gt; PHP 7.0 即可：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ brew unlink php56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Unlinking /usr/&lt;span class=&quot;built_in&quot;&gt;local&lt;/span&gt;/Cellar/php56/5.6.17... 18 symlinks removed&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ brew link php70&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Linking /usr/&lt;span class=&quot;built_in&quot;&gt;local&lt;/span&gt;/Cellar/php70/7.0.2... 17 symlinks created&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ php -v&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;PHP 7.0.2 (cli) (built: Jan  7 2016 10:40:26) ( NTS )&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Copyright (c) 1997-2015 The PHP Group&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Zend Engine v3.0.0, Copyright (c) 1998-2015 Zend Technologies&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;PHP-extenstions&quot;&gt;&lt;a href=&quot;#PHP-extenstions&quot; class=&quot;headerlink&quot; title=&quot;PHP extenstions&quot;&gt;&lt;/a&gt;PHP extenstions&lt;/h3&gt;&lt;p&gt;有時你可能需要安裝 PHP 的 extenstions，像是為了產生 PHPUnit 的 coverage report 就必須安裝 Xdebug，為了提升執行速度則裝 OPCache。&lt;/p&gt;
&lt;h4 id=&quot;安裝-extenstions&quot;&gt;&lt;a href=&quot;#安裝-extenstions&quot; class=&quot;headerlink&quot; title=&quot;安裝 extenstions&quot;&gt;&lt;/a&gt;安裝 extenstions&lt;/h4&gt;&lt;p&gt;所有的 PHP extenstions 都是以 &lt;code&gt;phpXX-*&lt;/code&gt; 來命名，也就是說如果你現在使用 PHP 7.0，那麼就會是 &lt;code&gt;php70-*&lt;/code&gt;。讓我們來搜尋 PHP 7.0 有哪些 extenstions 可以安裝：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ brew search php70&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;homebrew/php/php70                  homebrew/php/php70-imagick          homebrew/php/php70-mongodb          homebrew/php/php70-pthreads&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;homebrew/php/php70-amqp             homebrew/php/php70-intl             homebrew/php/php70-msgpack          homebrew/php/php70-rdkafka&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;homebrew/php/php70-apcu             homebrew/php/php70-kafka            homebrew/php/php70-mustache         homebrew/php/php70-redis&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;homebrew/php/php70-apcu-bc          homebrew/php/php70-libsodium        homebrew/php/php70-oauth            homebrew/php/php70-snmp&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;homebrew/php/php70-ast              homebrew/php/php70-lzf              homebrew/php/php70-opcache          homebrew/php/php70-tidy&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;homebrew/php/php70-blitz            homebrew/php/php70-mailparse        homebrew/php/php70-pcntl            homebrew/php/php70-uuid&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;homebrew/php/php70-ev               homebrew/php/php70-mcrypt           homebrew/php/php70-pdo-dblib        homebrew/php/php70-v8js&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;homebrew/php/php70-gmp              homebrew/php/php70-mecab            homebrew/php/php70-pdo-pgsql        homebrew/php/php70-xdebug&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;homebrew/php/php70-hprose           homebrew/php/php70-memcached        homebrew/php/php70-pspell           homebrew/php/php70-yaml&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;你會看到一拖車的 extenstions，這邊我以 Xdebug 為例：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ brew install php70-xdebug&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;然後看看你的 PHP 版本，Xdebug 應該已經安裝完成：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ php -v&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;PHP 7.0.2 (cli) (built: Jan  7 2016 10:40:26) ( NTS )&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Copyright (c) 1997-2015 The PHP Group&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Zend Engine v3.0.0, Copyright (c) 1998-2015 Zend Technologies&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    with Xdebug v2.4.0RC3, Copyright (c) 2002-2015, by Derick Rethans&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&quot;關閉-extenstions&quot;&gt;&lt;a href=&quot;#關閉-extenstions&quot; class=&quot;headerlink&quot; title=&quot;關閉 extenstions&quot;&gt;&lt;/a&gt;關閉 extenstions&lt;/h4&gt;&lt;p&gt;所有的 extenstions 啟用檔案都會存放在 &lt;code&gt;/usr/local/etc/php/X.X/conf.d/ext-*.ini&lt;/code&gt;，以剛剛安裝的 Xdebug 為例，他的檔案會存放在 &lt;code&gt;/usr/local/etc/php/7.0/conf.d/ext-xdebug.ini&lt;/code&gt;。若要關閉該 extenstions，用編輯器編輯他即可：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;sudo vim /usr/&lt;span class=&quot;built_in&quot;&gt;local&lt;/span&gt;/etc/php/7.0/conf.d/ext-xdebug.ini&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;檔案內容很簡單：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;[xdebug]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;zend_extension=&lt;span class=&quot;string&quot;&gt;&quot;/usr/local/opt/php70-xdebug/xdebug.so&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;若要關閉，把第二行註解掉在存檔即可：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;[xdebug]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# zend_extension=&quot;/usr/local/opt/php70-xdebug/xdebug.so&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;註解完後就關閉了：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ php -v&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;PHP 7.0.2 (cli) (built: Jan  7 2016 10:40:26) ( NTS )&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Copyright (c) 1997-2015 The PHP Group&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Zend Engine v3.0.0, Copyright (c) 1998-2015 Zend Technologies&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;Done！&quot;&gt;&lt;a href=&quot;#Done！&quot; class=&quot;headerlink&quot; title=&quot;Done！&quot;&gt;&lt;/a&gt;Done！&lt;/h2&gt;&lt;p&gt;到此就完成囉，其實安裝起來不會很困難，操作起來也很簡單。相比 *AMP 與 Homestead，使用的資源及容量也輕巧很多。希望本篇可以提供給操作 terminal 一段時間的人做參考，畢竟自幹環境比起一鍵安裝包安心多了 XD，想裝就裝，想砍就砍！&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;div class=&quot;tip&quot;&gt;&lt;br&gt;建議你熟悉 Terminal 的操作再參考本篇，否則容易把系統環境搞亂。&lt;br&gt;&lt;/div&gt;

&lt;p&gt;在開發 Laravel Application 時，新手可能使用 *AMP 的系統環境整合包，而大多數人會選擇官方所提供的 &lt;a href=&quot;https://laravel.tw/docs/5.2/homestead&quot;&gt;Homestead&lt;/a&gt;。但 Homestead 其實就是一包很大包的虛擬機再配上 Vargrant，曾幾何時我也是使用 Homestead，但是因為我的小 Macbook Air 實在是受不了虛擬機容量一大包，又吃一堆記憶體。&lt;/p&gt;
&lt;p&gt;雖然標題是寫 Laravel，但是要應用在其他的 PHP Application 也是可行的。本篇就以 Homebrew 為主軸，打造 Laravel 的開發環境。&lt;/p&gt;
    
    </summary>
    
      <category term="notes" scheme="http://jigsawye.com/categories/notes/"/>
    
    
      <category term="terminal" scheme="http://jigsawye.com/tags/terminal/"/>
    
      <category term="php" scheme="http://jigsawye.com/tags/php/"/>
    
      <category term="laravel" scheme="http://jigsawye.com/tags/laravel/"/>
    
      <category term="mariadb" scheme="http://jigsawye.com/tags/mariadb/"/>
    
      <category term="redis" scheme="http://jigsawye.com/tags/redis/"/>
    
      <category term="homebrew" scheme="http://jigsawye.com/tags/homebrew/"/>
    
  </entry>
  
  <entry>
    <title>在 laravel 5 實作瀏覽器推播通知</title>
    <link href="http://jigsawye.com/2015/12/22/push-notification-to-user-in-laravel-5/"/>
    <id>http://jigsawye.com/2015/12/22/push-notification-to-user-in-laravel-5/</id>
    <published>2015-12-21T17:01:00.000Z</published>
    <updated>2016-02-04T06:09:00.000Z</updated>
    
    <content type="html">&lt;p&gt;今天在逛 &lt;a href=&quot;https://phphub.org&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;PHPHub&lt;/a&gt; 時剛好看到&lt;a href=&quot;https://phphub.org/topics/1585&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;這篇&lt;/a&gt;，想著之前也想做類似 Facebook 的通知服務，剛好之前也有碰過一陣子的 socket.io，所以就試著實做看看了。不過推播通知在手機上是相當常見的，但在 Web 上不知為何卻相當少見，也可能是我見識太淺了，看過的網站太少XD。&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/jigsawye/laravel-push-notification-demo&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;本文的原始碼&lt;/a&gt;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;!-- toc --&gt;
&lt;h2 id=&quot;起手式&quot;&gt;&lt;a href=&quot;#起手式&quot; class=&quot;headerlink&quot; title=&quot;起手式&quot;&gt;&lt;/a&gt;起手式&lt;/h2&gt;&lt;p&gt;首先我們需要先建 Laravel 專案：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ laravel new notification&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ &lt;span class=&quot;built_in&quot;&gt;cd&lt;/span&gt; notification&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ composer install&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ npm install&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;設定你的 &lt;code&gt;.env&lt;/code&gt;，除了資料庫外我們還會使用到&lt;strong&gt;隊列（Queue）&lt;/strong&gt;及&lt;strong&gt;廣播（broadcast）&lt;/strong&gt;，看起來會像：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;figcaption&gt;&lt;span&gt;.env&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;...&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;QUEUE_DRIVER=redis&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;BROADCAST_DRIVER=redis&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;...&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;要使用 Redis 必須在 Composer 安裝 &lt;code&gt;predis/predis&lt;/code&gt;：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ composer require predis/predis&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;接著執行遷移，跟 5.2 提供的 Auth scaffold（幫我們把 Auth 的部分連 View 都建完）：&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ php artisan migrate&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ php artisan make:auth&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;試試看應用程式有沒有正常執行，最後新增兩個使用者，看要在瀏覽器直接建立，或是其他方式也可以。&lt;/p&gt;
&lt;h2 id=&quot;什麼是隊列&quot;&gt;&lt;a href=&quot;#什麼是隊列&quot; class=&quot;headerlink&quot; title=&quot;什麼是隊列&quot;&gt;&lt;/a&gt;什麼是隊列&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://laravel.tw/docs/5.1/queues#introduction&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;隊列&lt;/a&gt;簡單來說就像是 JavaScript 的非同步機制，讓你把一個耗時的工作丟給別人做，你的程式會跳過這部分繼續執行。最常見到的案例就是寄 e-mail 跟簡訊。&lt;/p&gt;
&lt;h2 id=&quot;什麼是廣播&quot;&gt;&lt;a href=&quot;#什麼是廣播&quot; class=&quot;headerlink&quot; title=&quot;什麼是廣播&quot;&gt;&lt;/a&gt;什麼是廣播&lt;/h2&gt;&lt;p&gt;我們會利用 Laravel 的&lt;a href=&quot;https://laravel.tw/docs/5.1/events#broadcasting-events&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;廣播事件&lt;/a&gt;做推送通知的服務，開始之前建議大概瀏覽一下文件，廣播的方式大概如下圖：&lt;/p&gt;
&lt;img src=&quot;/2015/12/22/push-notification-to-user-in-laravel-5/01.png&quot; alt=&quot;01.png&quot; title=&quot;&quot;&gt;
&lt;p&gt;流程如下：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;在 Laravel 執行一個推播通知事件&lt;/li&gt;
&lt;li&gt;推播通知事件的資訊會推送至 Redis 中&lt;/li&gt;
&lt;li&gt;Node 端會訂閱該 Redis 的頻道，接收到推播通知事件的資訊&lt;/li&gt;
&lt;li&gt;透過 websocket 將推播通知送給使用者&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;建立推播通知事件&quot;&gt;&lt;a href=&quot;#建立推播通知事件&quot; class=&quot;headerlink&quot; title=&quot;建立推播通知事件&quot;&gt;&lt;/a&gt;建立推播通知事件&lt;/h2&gt;&lt;p&gt;首先先讓我們建立一個推播通知事件，所有的推播都會透過此事件推送到 Redis：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ php artisan make:event PushNotification&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;程式碼如下：&lt;/p&gt;
&lt;figure class=&quot;highlight php&quot;&gt;&lt;figcaption&gt;&lt;span&gt;app/Events/PushNotification.php&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;&amp;lt;?php&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;namespace&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;App&lt;/span&gt;\&lt;span class=&quot;title&quot;&gt;Events&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;use&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;App&lt;/span&gt;\&lt;span class=&quot;title&quot;&gt;Events&lt;/span&gt;\&lt;span class=&quot;title&quot;&gt;Event&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;use&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;App&lt;/span&gt;\&lt;span class=&quot;title&quot;&gt;User&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;use&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;Illuminate&lt;/span&gt;\&lt;span class=&quot;title&quot;&gt;Queue&lt;/span&gt;\&lt;span class=&quot;title&quot;&gt;SerializesModels&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;use&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;Illuminate&lt;/span&gt;\&lt;span class=&quot;title&quot;&gt;Contracts&lt;/span&gt;\&lt;span class=&quot;title&quot;&gt;Broadcasting&lt;/span&gt;\&lt;span class=&quot;title&quot;&gt;ShouldBroadcast&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;PushNotification&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;Event&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;implements&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;ShouldBroadcast&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;use&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;SerializesModels&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;/**&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;     * &lt;span class=&quot;doctag&quot;&gt;@var&lt;/span&gt; string&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;     */&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; $token;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;/**&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;     * &lt;span class=&quot;doctag&quot;&gt;@var&lt;/span&gt; string&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;     */&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; $message;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;/**&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;     * Create a new event instance.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;     *&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;     * &lt;span class=&quot;doctag&quot;&gt;@param&lt;/span&gt; User $user&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;     * &lt;span class=&quot;doctag&quot;&gt;@param&lt;/span&gt;      $message&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;     */&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;__construct&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(User $user, $message)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        $this-&amp;gt;token = sha1($user-&amp;gt;id . &lt;span class=&quot;string&quot;&gt;&#39;|&#39;&lt;/span&gt; . $user-&amp;gt;email);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        $this-&amp;gt;message = $message;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;/**&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;     * Get the channels the event should be broadcast on.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;     *&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;     * &lt;span class=&quot;doctag&quot;&gt;@return&lt;/span&gt; array&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;     */&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;broadcastOn&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; [&lt;span class=&quot;string&quot;&gt;&#39;notification&#39;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;我們的事件會有兩個屬性，一個是要推播的 &lt;code&gt;message&lt;/code&gt;，另一個比較特別的則是 &lt;code&gt;token&lt;/code&gt;。&lt;code&gt;token&lt;/code&gt; 會作為 socket.io 中 room 的名稱，代表一個使用者。也就是說一個使用者只會有一個 room（&lt;code&gt;token&lt;/code&gt;），這麼做可以讓我們指定要推播給哪個使用者。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;broadcastOn&lt;/code&gt; 則是設定在 Redis 中的頻道名稱，我們會在 socket.io server 端透過這個名稱來訂閱由此事件傳遞的資訊。&lt;/p&gt;
&lt;p&gt;若不太明白可以先接著往下看，會有更詳細的說明。&lt;/p&gt;
&lt;div class=&quot;tip&quot;&gt;&lt;br&gt;&lt;code&gt;token&lt;/code&gt; 的雜湊方式可以隨你喜歡更改，但要確定每次雜湊出來的值都相同，因為我們在 render view 給使用者的時候也會雜湊一組 token 給前端的 JavaScript，以加入 socket.io 中特定的 room。&lt;br&gt;&lt;/div&gt;

&lt;h2 id=&quot;建立-Socket-io-Server&quot;&gt;&lt;a href=&quot;#建立-Socket-io-Server&quot; class=&quot;headerlink&quot; title=&quot;建立 Socket.io Server&quot;&gt;&lt;/a&gt;建立 Socket.io Server&lt;/h2&gt;&lt;p&gt;我們的 socket.io 會有兩個任務：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;接收由 Laravel 的 PushNotification 事件送來的推播資訊&lt;/li&gt;
&lt;li&gt;將內容透過 websocket 推播給使用者&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;讓我們先使用 npm 安裝必要的套件：分別是 &lt;code&gt;express&lt;/code&gt;（http server）、&lt;code&gt;socket.io&lt;/code&gt;（websocket server）及 &lt;code&gt;ioredis&lt;/code&gt;（訂閱 redis）：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ npm install express socket.io ioredis --save&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;接著我們建立 &lt;code&gt;socket.js&lt;/code&gt;，先寫 redis 部份的程式碼測試與 Laravel 廣播事件的串接是否有問題：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;figcaption&gt;&lt;span&gt;socket.js&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; Redis = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;ioredis&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; redis = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Redis();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 訂閱 redis 的 notification 頻道，也就是我們在事件中 broadcastOn 所設定的&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;redis.subscribe(&lt;span class=&quot;string&quot;&gt;&#39;notification&#39;&lt;/span&gt;, &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;err, count&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(&lt;span class=&quot;string&quot;&gt;&#39;connect!&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 當該頻道接收到訊息時就列在 terminal 上&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;redis.on(&lt;span class=&quot;string&quot;&gt;&#39;message&#39;&lt;/span&gt;, &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;channel, notification&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(notification);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;測試與-Laravel-是否正確串接&quot;&gt;&lt;a href=&quot;#測試與-Laravel-是否正確串接&quot; class=&quot;headerlink&quot; title=&quot;測試與 Laravel 是否正確串接&quot;&gt;&lt;/a&gt;測試與 Laravel 是否正確串接&lt;/h3&gt;&lt;p&gt;首先你必須先確認這些東西有沒有執行：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Laravel Application（Nginx or &lt;code&gt;php artisan serve&lt;/code&gt;）&lt;/li&gt;
&lt;li&gt;Redis server&lt;/li&gt;
&lt;li&gt;隊列監聽器（&lt;code&gt;php artisan queue:listen&lt;/code&gt;）&lt;/li&gt;
&lt;li&gt;socket.io server（&lt;code&gt;node socket.js&lt;/code&gt;）&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;確認完畢後，我們進入 Laravel 的 Tinker 做測試：&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ php artisan tinker&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;img src=&quot;/2015/12/22/push-notification-to-user-in-laravel-5/test-event.gif&quot; alt=&quot;test-event.gif&quot; title=&quot;&quot;&gt;
&lt;p&gt;我們直接觸發事件：&lt;/p&gt;
&lt;figure class=&quot;highlight php&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;event(&lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; App\Events\PushNotification(App\User::first(), &lt;span class=&quot;string&quot;&gt;&#39;banana!&#39;&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;你應該在 node 的 terminal 看到：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&amp;#123;&lt;span class=&quot;string&quot;&gt;&quot;event&quot;&lt;/span&gt;:&lt;span class=&quot;string&quot;&gt;&quot;App\\Events\\PushNotification&quot;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&quot;data&quot;&lt;/span&gt;:&amp;#123;&lt;span class=&quot;string&quot;&gt;&quot;token&quot;&lt;/span&gt;:&lt;span class=&quot;string&quot;&gt;&quot;long-hash-string&quot;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&quot;message&quot;&lt;/span&gt;:&lt;span class=&quot;string&quot;&gt;&quot;banana!&quot;&lt;/span&gt;&amp;#125;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;連接前端與-socket-io&quot;&gt;&lt;a href=&quot;#連接前端與-socket-io&quot; class=&quot;headerlink&quot; title=&quot;連接前端與 socket.io&quot;&gt;&lt;/a&gt;連接前端與 socket.io&lt;/h2&gt;&lt;h3 id=&quot;前端&quot;&gt;&lt;a href=&quot;#前端&quot; class=&quot;headerlink&quot; title=&quot;前端&quot;&gt;&lt;/a&gt;前端&lt;/h3&gt;&lt;p&gt;首先我們必須先安裝 &lt;code&gt;socket.io-client&lt;/code&gt;，這是 socket.io 在前端所使用的套件，我們會透過 server side 的開發方式，再透過 elixir 的 browserify 轉成前端可執行的 JavaScript。&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ npm install socket.io-client --save&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;建立 &lt;code&gt;resources/assets/js/app.js&lt;/code&gt;，撰寫以下程式碼：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;figcaption&gt;&lt;span&gt;resources/assets/js/app.js&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; io = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;socket.io-client&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 建立 socket.io 的連線&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; notification = io.connect(&lt;span class=&quot;string&quot;&gt;&#39;http://localhost:3000&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 當從 socket.io server 收到 notification 時將訊息印在 console 上&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;notification.on(&lt;span class=&quot;string&quot;&gt;&#39;notification&#39;&lt;/span&gt;, &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;message&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(message);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;接著修改 &lt;code&gt;gulpfile.js&lt;/code&gt;，然後執行 &lt;code&gt;gulp&lt;/code&gt;，他會將編譯結果放在 &lt;code&gt;public/js/app.js&lt;/code&gt;：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;figcaption&gt;&lt;span&gt;gulpfile.js&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;elixir(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;mix&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    mix.browserify(&lt;span class=&quot;string&quot;&gt;&#39;app.js&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;接著我們希望在 &lt;code&gt;/home&lt;/code&gt; 能接收推播（5.2 的 &lt;code&gt;make:auth&lt;/code&gt; 預設提供 &lt;code&gt;/home&lt;/code&gt; 作為登入後的首頁），所以先在 &lt;code&gt;resources/views/layouts/app.blade.php&lt;/code&gt; 下方加上 &lt;code&gt;@yield(&amp;#39;scripts&amp;#39;)&lt;/code&gt; ，看起來會像這樣：&lt;br&gt;&lt;figure class=&quot;highlight html&quot;&gt;&lt;figcaption&gt;&lt;span&gt;resources/views/layouts/app.blade.php&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;...&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;div&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;nav&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;@yield(&#39;content&#39;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;@yield(&#39;scripts&#39;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;&amp;lt;!-- JavaScripts --&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#123;&amp;#123;-- &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;script&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;src&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;&amp;#123;&amp;#123; elixir(&#39;js/app.js&#39;) &amp;#125;&amp;#125;&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;undefined&quot;&gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt; --&amp;#125;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;...&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;然後在 &lt;code&gt;resources/views/home.blade.php&lt;/code&gt; 下面載入剛剛寫好的 JavaScript：&lt;/p&gt;
&lt;figure class=&quot;highlight html&quot;&gt;&lt;figcaption&gt;&lt;span&gt;resources/views/home.blade.php&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;@section(&#39;content&#39;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;script&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;src&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;/js/app.js&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;undefined&quot;&gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;@endsection&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;後端&quot;&gt;&lt;a href=&quot;#後端&quot; class=&quot;headerlink&quot; title=&quot;後端&quot;&gt;&lt;/a&gt;後端&lt;/h3&gt;&lt;p&gt;修改剛剛的 &lt;code&gt;socket.js&lt;/code&gt;，增加 socket.io 及推送通知至前端的程式碼：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;figcaption&gt;&lt;span&gt;socket.js&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; app = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;express&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; http = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;http&#39;&lt;/span&gt;).Server(app);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; io = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;socket.io&#39;&lt;/span&gt;)(http);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; Redis = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;ioredis&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; redis = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Redis();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;redis.subscribe(&lt;span class=&quot;string&quot;&gt;&#39;notification&#39;&lt;/span&gt;, &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;err, count&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(&lt;span class=&quot;string&quot;&gt;&#39;connect!&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;redis.on(&lt;span class=&quot;string&quot;&gt;&#39;message&#39;&lt;/span&gt;, &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;channel, notification&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(notification);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  notification = &lt;span class=&quot;built_in&quot;&gt;JSON&lt;/span&gt;.parse(notification);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;comment&quot;&gt;// 將訊息推播給使用者&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  io.emit(&lt;span class=&quot;string&quot;&gt;&#39;notification&#39;&lt;/span&gt;, notification.data.message);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 監聽 3000 port&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;http.listen(&lt;span class=&quot;number&quot;&gt;3000&lt;/span&gt;, &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(&lt;span class=&quot;string&quot;&gt;&#39;Listening on Port 3000&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;接著就可以測試前端是否可以收到通知了！&lt;/p&gt;
&lt;img src=&quot;/2015/12/22/push-notification-to-user-in-laravel-5/test-socket.gif&quot; alt=&quot;test-socket.gif&quot; title=&quot;&quot;&gt;
&lt;h2 id=&quot;區分使用者&quot;&gt;&lt;a href=&quot;#區分使用者&quot; class=&quot;headerlink&quot; title=&quot;區分使用者&quot;&gt;&lt;/a&gt;區分使用者&lt;/h2&gt;&lt;p&gt;如果你有開不同瀏覽器登入不同使用者的話會發現，不管你在事件的 &lt;code&gt;User&lt;/code&gt; 傳入誰，每個使用者都會收到通知。&lt;/p&gt;
&lt;p&gt;因為所有使用者都屬於同一個 channel（&lt;code&gt;notification&lt;/code&gt;）。這時就要使用 &lt;code&gt;token&lt;/code&gt; 及 socket.io 的 room 來區分使用者。每個 &lt;code&gt;token&lt;/code&gt; 代表一個 room，也就是一個使用者，我們就可以由 Laravel 廣播事件內的 token 決定要接推播通知傳給哪個使用者：&lt;/p&gt;
&lt;img src=&quot;/2015/12/22/push-notification-to-user-in-laravel-5/02.png&quot; alt=&quot;02.png&quot; title=&quot;&quot;&gt;
&lt;h3 id=&quot;前端-1&quot;&gt;&lt;a href=&quot;#前端-1&quot; class=&quot;headerlink&quot; title=&quot;前端&quot;&gt;&lt;/a&gt;前端&lt;/h3&gt;&lt;p&gt;我們要做的事情有：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;在 Controller 產生 &lt;code&gt;token&lt;/code&gt;（與事件中的相同），並傳遞至 View&lt;/li&gt;
&lt;li&gt;前端的 JavaScript 取得 &lt;code&gt;token&lt;/code&gt;，並傳給 socket.io server 加入指定的 room&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;首先，先修改 &lt;code&gt;HomeControllr@index&lt;/code&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight php&quot;&gt;&lt;figcaption&gt;&lt;span&gt;app/Http/Controllers/HomeControllr.php&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;/**&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; * Show the application dashboard.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; *&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; * &lt;span class=&quot;doctag&quot;&gt;@return&lt;/span&gt; Response&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; */&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Request $request)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    $user = $request-&amp;gt;user();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    $token = sha1($user-&amp;gt;id . &lt;span class=&quot;string&quot;&gt;&#39;|&#39;&lt;/span&gt; . $user-&amp;gt;email);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; view(&lt;span class=&quot;string&quot;&gt;&#39;home&#39;&lt;/span&gt;, compact(&lt;span class=&quot;string&quot;&gt;&#39;token&#39;&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;接著修改剛剛新增在 &lt;code&gt;resources/views/home.blade.php&lt;/code&gt; 的部分，將 &lt;code&gt;token&lt;/code&gt; 傳至 JavaScript 中：&lt;/p&gt;
&lt;figure class=&quot;highlight html&quot;&gt;&lt;figcaption&gt;&lt;span&gt;resources/views/home.blade.php&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;...&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;@section(&#39;content&#39;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;javascript&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Notification.TOKEN = &lt;span class=&quot;string&quot;&gt;&#39;&amp;#123;&amp;#123; $token or null &amp;#125;&amp;#125;&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;script&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;src&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;/js/app.js&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;undefined&quot;&gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;@endsection&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;修改 &lt;code&gt;resources/assets/js/app.js&lt;/code&gt;，使用 &lt;code&gt;token&lt;/code&gt; 加入使用者的 room：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;figcaption&gt;&lt;span&gt;resources/assets/js/app.js&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; io = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;socket.io-client&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; notification = io.connect(&lt;span class=&quot;string&quot;&gt;&#39;http://localhost:3000&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 當連接到 socket.io server 時觸發 set-token 設定使用者的 room&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;notification.on(&lt;span class=&quot;string&quot;&gt;&#39;connect&#39;&lt;/span&gt;, &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  notification.emit(&lt;span class=&quot;string&quot;&gt;&#39;set-token&#39;&lt;/span&gt;, Notification.TOKEN);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;notification.on(&lt;span class=&quot;string&quot;&gt;&#39;notification&#39;&lt;/span&gt;, &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;message&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(message);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;後端-1&quot;&gt;&lt;a href=&quot;#後端-1&quot; class=&quot;headerlink&quot; title=&quot;後端&quot;&gt;&lt;/a&gt;後端&lt;/h3&gt;&lt;p&gt;修改 &lt;code&gt;socket.js&lt;/code&gt;，讓使用者加入屬於他的 room，並由 Laravel 廣播事件資訊內的 token 決定要傳給哪個使用者（room）：&lt;br&gt;&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; app = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;express&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; http = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;http&#39;&lt;/span&gt;).Server(app);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; io = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;socket.io&#39;&lt;/span&gt;)(http);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; Redis = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;ioredis&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; redis = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Redis();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;redis.subscribe(&lt;span class=&quot;string&quot;&gt;&#39;notification&#39;&lt;/span&gt;, &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;err, count&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(&lt;span class=&quot;string&quot;&gt;&#39;connect!&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;io.on(&lt;span class=&quot;string&quot;&gt;&#39;connection&#39;&lt;/span&gt;, &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;socket&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;comment&quot;&gt;// 當使用者觸發 set-token 時將他加入屬於他的 room&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  socket.on(&lt;span class=&quot;string&quot;&gt;&#39;set-token&#39;&lt;/span&gt;, &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;token&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(token);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    socket.join(&lt;span class=&quot;string&quot;&gt;&#39;token:&#39;&lt;/span&gt; + token);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;redis.on(&lt;span class=&quot;string&quot;&gt;&#39;message&#39;&lt;/span&gt;, &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;channel, notification&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(notification);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  notification = &lt;span class=&quot;built_in&quot;&gt;JSON&lt;/span&gt;.parse(notification);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;comment&quot;&gt;// 使用 to() 指定傳送的 room，也就是傳遞給指定的使用者&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  io.to(&lt;span class=&quot;string&quot;&gt;&#39;token:&#39;&lt;/span&gt; + notification.data.token).emit(&lt;span class=&quot;string&quot;&gt;&#39;notification&#39;&lt;/span&gt;, notification.data.message);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 監聽 3000 port&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;http.listen(&lt;span class=&quot;number&quot;&gt;3000&lt;/span&gt;, &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(&lt;span class=&quot;string&quot;&gt;&#39;Listening on Port 3000&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h2 id=&quot;Demo&quot;&gt;&lt;a href=&quot;#Demo&quot; class=&quot;headerlink&quot; title=&quot;Demo&quot;&gt;&lt;/a&gt;Demo&lt;/h2&gt;&lt;img src=&quot;/2015/12/22/push-notification-to-user-in-laravel-5/demo.gif&quot; alt=&quot;demo.gif&quot; title=&quot;&quot;&gt;
&lt;p&gt;基本上前端收的到通知之後，如何呈現就不是困難的問題了。&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/jigsawye/laravel-push-notification-demo&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;本文的原始碼&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;後記&quot;&gt;&lt;a href=&quot;#後記&quot; class=&quot;headerlink&quot; title=&quot;後記&quot;&gt;&lt;/a&gt;後記&lt;/h2&gt;&lt;p&gt;實作其實沒那麼困難，不過如果真的要上 Production 的話還是得再思考一下！因為感覺這個 Solution 沒有很透徹XD！&lt;/p&gt;
&lt;p&gt;像是 token 的部分這樣安全性不知道會不會不佳，如果想更安全可以用更複雜的演算法，或是在 Laravel 跟 socket.io server 用相同的加密演算法，互相加解密也可以。作法應該還很多種，有厲害的大大還麻煩幫忙補充XD&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;今天在逛 &lt;a href=&quot;https://phphub.org&quot;&gt;PHPHub&lt;/a&gt; 時剛好看到&lt;a href=&quot;https://phphub.org/topics/1585&quot;&gt;這篇&lt;/a&gt;，想著之前也想做類似 Facebook 的通知服務，剛好之前也有碰過一陣子的 socket.io，所以就試著實做看看了。不過推播通知在手機上是相當常見的，但在 Web 上不知為何卻相當少見，也可能是我見識太淺了，看過的網站太少XD。&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/jigsawye/laravel-push-notification-demo&quot;&gt;本文的原始碼&lt;/a&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="tutorial" scheme="http://jigsawye.com/categories/tutorial/"/>
    
    
      <category term="javascript" scheme="http://jigsawye.com/tags/javascript/"/>
    
      <category term="php" scheme="http://jigsawye.com/tags/php/"/>
    
      <category term="laravel" scheme="http://jigsawye.com/tags/laravel/"/>
    
      <category term="laravel5" scheme="http://jigsawye.com/tags/laravel5/"/>
    
      <category term="notification" scheme="http://jigsawye.com/tags/notification/"/>
    
      <category term="socket-io" scheme="http://jigsawye.com/tags/socket-io/"/>
    
  </entry>
  
  <entry>
    <title>在 OSX 的終端機正常瀏覽 PTT</title>
    <link href="http://jigsawye.com/2015/12/06/ptt-in-osx-terminal/"/>
    <id>http://jigsawye.com/2015/12/06/ptt-in-osx-terminal/</id>
    <published>2015-12-06T12:21:51.000Z</published>
    <updated>2016-01-18T11:58:25.000Z</updated>
    
    <content type="html">&lt;p&gt;在 OSX 的終端機連線至 PTT，會因為編碼問題而產生亂碼。&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;img src=&quot;/2015/12/06/ptt-in-osx-terminal/01.png&quot; alt=&quot;01.png&quot; title=&quot;&quot;&gt;
&lt;h2 id=&quot;使用-SSH-連線&quot;&gt;&lt;a href=&quot;#使用-SSH-連線&quot; class=&quot;headerlink&quot; title=&quot;使用 SSH 連線&quot;&gt;&lt;/a&gt;使用 SSH 連線&lt;/h2&gt;&lt;p&gt;其實我們只要改用 SSH 連線至 PTT 就可以解決這個問題了：&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ ssh bbsu@ptt.cc&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;img src=&quot;/2015/12/06/ptt-in-osx-terminal/02.png&quot; alt=&quot;02.png&quot; title=&quot;&quot;&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;在 OSX 的終端機連線至 PTT，會因為編碼問題而產生亂碼。&lt;/p&gt;
    
    </summary>
    
      <category term="note" scheme="http://jigsawye.com/categories/note/"/>
    
    
      <category term="terminal" scheme="http://jigsawye.com/tags/terminal/"/>
    
  </entry>
  
  <entry>
    <title>防止 SSH 因長時間未動作而斷線</title>
    <link href="http://jigsawye.com/2015/12/06/prevent-ssh-disconnect/"/>
    <id>http://jigsawye.com/2015/12/06/prevent-ssh-disconnect/</id>
    <published>2015-12-06T12:11:11.000Z</published>
    <updated>2015-12-06T12:25:49.000Z</updated>
    
    <content type="html">&lt;p&gt;在使用 SSH 連線到遠端主機時，常常因為一段時間未動作而逾時斷線。要避免這樣的情形發生，&lt;br&gt;只要設定自己的 SSH 設定即可。&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h2 id=&quot;編輯-SSH-設定檔&quot;&gt;&lt;a href=&quot;#編輯-SSH-設定檔&quot; class=&quot;headerlink&quot; title=&quot;編輯 SSH 設定檔&quot;&gt;&lt;/a&gt;編輯 SSH 設定檔&lt;/h2&gt;&lt;p&gt;打開 &lt;code&gt;~/.ssh/config&lt;/code&gt; 檔案（如果沒有就建一個），加入以下：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;figcaption&gt;&lt;span&gt;~/.ssh/config&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;host *&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    ServerAliveInterval 60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;# 每 60 秒傳送一次封包&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;這麼做就會每 60 秒發送一次封包到遠端主機以保持連線。&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;在使用 SSH 連線到遠端主機時，常常因為一段時間未動作而逾時斷線。要避免這樣的情形發生，&lt;br&gt;只要設定自己的 SSH 設定即可。&lt;/p&gt;
    
    </summary>
    
      <category term="note" scheme="http://jigsawye.com/categories/note/"/>
    
    
      <category term="terminal" scheme="http://jigsawye.com/tags/terminal/"/>
    
  </entry>
  
  <entry>
    <title>在 iDevice 上執行 React Native（不需付費）</title>
    <link href="http://jigsawye.com/2015/11/30/running-react-native-on-device/"/>
    <id>http://jigsawye.com/2015/11/30/running-react-native-on-device/</id>
    <published>2015-11-30T15:16:22.000Z</published>
    <updated>2016-02-04T06:06:55.000Z</updated>
    
    <content type="html">&lt;p&gt;之前在練著寫 React Native 時詢問過開發 iOS 的朋友，能不能將 App 燒至自己的裝置上。當時好像因為 Apple 規範的關係，必須加入 &lt;a href=&quot;https://developer.apple.com/programs/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Developer Program&lt;/a&gt; 並 &lt;strong&gt;年付 $99&lt;/strong&gt; 取得憑證才行。而因為我沒有打算上架到 App Store 上所以只好放棄付錢作罷。&lt;/p&gt;
&lt;p&gt;最近剛好想寫一些自己的工具，又試著上網找了一下資料，發現在 XCode 7 之後已經開放未付費也可以燒至裝置上了，因此紀錄一下。&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;!-- toc --&gt;
&lt;h2 id=&quot;加入-Apple-ID-至-XCode&quot;&gt;&lt;a href=&quot;#加入-Apple-ID-至-XCode&quot; class=&quot;headerlink&quot; title=&quot;加入 Apple ID 至 XCode&quot;&gt;&lt;/a&gt;加入 Apple ID 至 XCode&lt;/h2&gt;&lt;p&gt;將 iDevice 透過 USB 連接，並在 XCode 選擇你的裝置：&lt;/p&gt;
&lt;img src=&quot;/2015/11/30/running-react-native-on-device/01.png&quot; alt=&quot;01.png&quot; title=&quot;&quot;&gt;
&lt;p&gt;按工具列的執行或 cmd + R 執行，接著會跳出錯誤告知你需要有效的憑證，這邊我們點 &lt;strong&gt;Fix issue&lt;/strong&gt;：&lt;/p&gt;
&lt;img src=&quot;/2015/11/30/running-react-native-on-device/02.png&quot; alt=&quot;02.png&quot; title=&quot;&quot;&gt;
&lt;p&gt;如果你沒有 Apple ID 或是還沒加入 Developer Program，就選左邊的 &lt;strong&gt;Join a Program&lt;/strong&gt;，如果你已經有了，就選擇 &lt;strong&gt;Add&lt;/strong&gt; 並填入你的 Apple ID：&lt;/p&gt;
&lt;img src=&quot;/2015/11/30/running-react-native-on-device/03.png&quot; alt=&quot;03.png&quot; title=&quot;&quot;&gt;
&lt;p&gt;接著你就可以看到帳號已經加入完成：&lt;/p&gt;
&lt;img src=&quot;/2015/11/30/running-react-native-on-device/04.png&quot; alt=&quot;04.png&quot; title=&quot;&quot;&gt;
&lt;h2 id=&quot;將-App-Build-至-iDevice-上&quot;&gt;&lt;a href=&quot;#將-App-Build-至-iDevice-上&quot; class=&quot;headerlink&quot; title=&quot;將 App Build 至 iDevice 上&quot;&gt;&lt;/a&gt;將 App Build 至 iDevice 上&lt;/h2&gt;&lt;p&gt;接著我們在 Build 一次，又跳出了一個錯誤，得知是安全性的問題：&lt;/p&gt;
&lt;img src=&quot;/2015/11/30/running-react-native-on-device/05.png&quot; alt=&quot;05.png&quot; title=&quot;&quot;&gt;
&lt;p&gt;打開你的裝置，依序選擇 &lt;strong&gt;設定&lt;/strong&gt;-&amp;gt;&lt;strong&gt;一般&lt;/strong&gt;-&amp;gt;&lt;strong&gt;描述檔&lt;/strong&gt;-&amp;gt;&lt;code&gt;你的 Apple ID&lt;/code&gt;-&amp;gt;&lt;strong&gt;信任「&lt;code&gt;你的 Apple ID&lt;/code&gt;」&lt;/strong&gt;：&lt;/p&gt;
&lt;img src=&quot;/2015/11/30/running-react-native-on-device/06.png&quot; alt=&quot;06.png&quot; title=&quot;&quot;&gt;
&lt;h2 id=&quot;執行你的-App&quot;&gt;&lt;a href=&quot;#執行你的-App&quot; class=&quot;headerlink&quot; title=&quot;執行你的 App&quot;&gt;&lt;/a&gt;執行你的 App&lt;/h2&gt;&lt;p&gt;完成後就可以執行你的 App 了，然後又出現了錯誤，因為路徑是 localhost，所以讀不到 bundle 檔案：&lt;/p&gt;
&lt;img src=&quot;/2015/11/30/running-react-native-on-device/07.png&quot; alt=&quot;07.png&quot; title=&quot;&quot;&gt;
&lt;p&gt;打開 XCode，在你的 Project 裡找到 &lt;code&gt;AppDelgate.m&lt;/code&gt; 檔案，將 &lt;code&gt;jsCodeLocation&lt;/code&gt; 中的 &lt;code&gt;localhost&lt;/code&gt; 修改成你的 IP：&lt;/p&gt;
&lt;img src=&quot;/2015/11/30/running-react-native-on-device/08.png&quot; alt=&quot;08.png&quot; title=&quot;&quot;&gt;
&lt;h2 id=&quot;Done&quot;&gt;&lt;a href=&quot;#Done&quot; class=&quot;headerlink&quot; title=&quot;Done!&quot;&gt;&lt;/a&gt;Done!&lt;/h2&gt;&lt;p&gt;完成！別忘了搖晃裝置可以叫出 dev menu，記得打開 Live Reload 讓開發更方便！&lt;/p&gt;
&lt;img src=&quot;/2015/11/30/running-react-native-on-device/09.png&quot; alt=&quot;09.png&quot; title=&quot;&quot;&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;之前在練著寫 React Native 時詢問過開發 iOS 的朋友，能不能將 App 燒至自己的裝置上。當時好像因為 Apple 規範的關係，必須加入 &lt;a href=&quot;https://developer.apple.com/programs/&quot;&gt;Developer Program&lt;/a&gt; 並 &lt;strong&gt;年付 $99&lt;/strong&gt; 取得憑證才行。而因為我沒有打算上架到 App Store 上所以只好放棄付錢作罷。&lt;/p&gt;
&lt;p&gt;最近剛好想寫一些自己的工具，又試著上網找了一下資料，發現在 XCode 7 之後已經開放未付費也可以燒至裝置上了，因此紀錄一下。&lt;/p&gt;
    
    </summary>
    
      <category term="note" scheme="http://jigsawye.com/categories/note/"/>
    
    
      <category term="react" scheme="http://jigsawye.com/tags/react/"/>
    
      <category term="react-native" scheme="http://jigsawye.com/tags/react-native/"/>
    
      <category term="xcode" scheme="http://jigsawye.com/tags/xcode/"/>
    
      <category term="ios" scheme="http://jigsawye.com/tags/ios/"/>
    
  </entry>
  
  <entry>
    <title>Redux 起手式：Actions、Reducers 及 Store</title>
    <link href="http://jigsawye.com/2015/11/29/instruction-with-redux/"/>
    <id>http://jigsawye.com/2015/11/29/instruction-with-redux/</id>
    <published>2015-11-29T03:23:33.000Z</published>
    <updated>2015-11-30T18:05:49.000Z</updated>
    
    <content type="html">&lt;p&gt;真正開始寫 &lt;a href=&quot;https://facebook.github.io/react/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;React&lt;/a&gt; 大概是這一兩個月的時間吧，印象中前幾個月正火紅的時候，觀望著開發架構，從 Facebook 剛開始的 &lt;a href=&quot;https://github.com/facebook/flux&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Flux&lt;/a&gt;，一路看到 &lt;a href=&quot;https://github.com/BinaryMuse/fluxxor&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;fluxxor&lt;/a&gt;、&lt;a href=&quot;https://github.com/goatslacker/alt&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;alt&lt;/a&gt; 這些 Library 等等，真的是多到爆，然後那個 Flux 的概念圖看了不下 N 次，但還是不得其門而入。&lt;/p&gt;
&lt;p&gt;直到不久前出現了一個叫 &lt;a href=&quot;github.com/rackt/redux&quot;&gt;Redux&lt;/a&gt; 的東西，剛好有新 project 要用 React 寫，看著各方大神推薦就順勢跳進 Redux 的世界了。最近也利用 Redux 寫了個 &lt;a href=&quot;https://github.com/jigsawye/node-proxy-manager-client&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Proxy manager&lt;/a&gt;，趁最近期中考完，回頭寫一下 Redux 的核心概念。&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;!-- toc --&gt;
&lt;h2 id=&quot;那些在-React-遇到的麻煩事&quot;&gt;&lt;a href=&quot;#那些在-React-遇到的麻煩事&quot; class=&quot;headerlink&quot; title=&quot;那些在 React 遇到的麻煩事&quot;&gt;&lt;/a&gt;那些在 React 遇到的麻煩事&lt;/h2&gt;&lt;p&gt;你會有個 Root Component，然後它負責：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;有一株肥美的 state tree（狀態樹）管理下層元件的資料&lt;/li&gt;
&lt;li&gt;有一坨負責處理資料的 function 透過 props 傳遞給下層元件呼叫，以改變上面那棵樹&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;所以呢，Facebook 就建議了一種 Flux 架構，把那些 function 及 state tree 給抽出來集中管理。&lt;/p&gt;
&lt;h2 id=&quot;為什麼選-Redux&quot;&gt;&lt;a href=&quot;#為什麼選-Redux&quot; class=&quot;headerlink&quot; title=&quot;為什麼選 Redux&quot;&gt;&lt;/a&gt;為什麼選 Redux&lt;/h2&gt;&lt;p&gt;以我來說有這幾個原因：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;概念很簡單，只要清楚 Actions 及 Reducer 就可以開始實做了&lt;/li&gt;
&lt;li&gt;API 很少，而且只是幾個單純的 function，還有很方便的 Middleware 可以用&lt;/li&gt;
&lt;li&gt;有完善的 devtools，可回溯的 state&lt;/li&gt;
&lt;li&gt;社群資源多，而且我觀察台灣大多數 React 開發者都選用 Redux&lt;/li&gt;
&lt;li&gt;官方文件有中文版（&lt;a href=&quot;http://chentsulin.github.io/redux/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;由此去&lt;/a&gt;），而且有完整的 step by step example&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;所以那個流程&quot;&gt;&lt;a href=&quot;#所以那個流程&quot; class=&quot;headerlink&quot; title=&quot;所以那個流程&quot;&gt;&lt;/a&gt;所以那個流程&lt;/h2&gt;&lt;p&gt;我以很常見的 counter（計數器）為例，假設我要將目前的數字 + 1：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;dispatch（發送）一個 increment（+ 1）的 Action（動作）&lt;/li&gt;
&lt;li&gt;管理 counter 的 reducer 接收到 action 後將 state 中目前的數字 + 1&lt;/li&gt;
&lt;li&gt;state tree 及 reducers 由 store 集中管理，並由 React 取用&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;Action&quot;&gt;&lt;a href=&quot;#Action&quot; class=&quot;headerlink&quot; title=&quot;Action&quot;&gt;&lt;/a&gt;Action&lt;/h3&gt;&lt;p&gt;就以剛剛的 Todo 為例，actions 基本上就只是一個 JavaScript 物件，只需要定義好這個 action 的 type（類型）即可，當這個 action 被 dispatch 時，這個物件就會被傳至 reudcer，所以若有資料需要傳入，只需要加在這個 action 物件中：&lt;br&gt;&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  type: &lt;span class=&quot;string&quot;&gt;&#39;INCREMENT&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;一般來說會向下方這樣把 type 定義成常數做取用，不過這邊就盡量精簡化了：&lt;br&gt;&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; INCREMENT = &lt;span class=&quot;string&quot;&gt;&#39;INCREMENT&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h3 id=&quot;Reducer&quot;&gt;&lt;a href=&quot;#Reducer&quot; class=&quot;headerlink&quot; title=&quot;Reducer&quot;&gt;&lt;/a&gt;Reducer&lt;/h3&gt;&lt;p&gt;reducer 則是一個 function，負責接收被 dispatch 的 action 並處理 state，要注意的是需傳入兩個參數到這個 function，第一個是目前的 state，第二個則是我們定義的 action 物件：&lt;br&gt;&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;counter&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;state = 0, action&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;comment&quot;&gt;// 在這邊回傳處理好的 state&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;就是這麼簡單的 function，要注意的是，初始化的時候 state 是空的，所以在第一個參數放了預設的 state。&lt;br&gt;接著就是撰寫處理 state 的部分：&lt;br&gt;&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;counter&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;state = 0, action&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;switch&lt;/span&gt; (action.type) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;INCREMENT&#39;&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; state + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;default&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; state;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;還記得在 action 定義的 type 吧？我們會在 reducer 中根據 action 物件中的 type 去對應要執行的動作，接著回傳處理完的 state。&lt;/p&gt;
&lt;h3 id=&quot;Store&quot;&gt;&lt;a href=&quot;#Store&quot; class=&quot;headerlink&quot; title=&quot;Store&quot;&gt;&lt;/a&gt;Store&lt;/h3&gt;&lt;p&gt;我們現在知道了定義的 action 及處理 state 的 reducer，最後我們則需要透過 redux 的 &lt;code&gt;createStore&lt;/code&gt; 將 reducer 轉換成 store：&lt;br&gt;&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; &amp;#123; createStore &amp;#125; &lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;redux&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 如果透過瀏覽器的方式執行的話可以寫成下面這樣&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// const &amp;#123; createStore &amp;#125; = Redux;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 產生 store&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; store = createStore(counter);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;對，就這麼一行，接著你就可以開始透過 action 操作 state 了：&lt;br&gt;&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 透過 getState() 取得目前的 state&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(store.getState());&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 透過 dispatch() 發送我們剛剛所定義的 action&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;store.dispatch(&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  type: &lt;span class=&quot;string&quot;&gt;&#39;INCREMENT&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 看執行後的 state&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(store.getState());&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h2 id=&quot;Done&quot;&gt;&lt;a href=&quot;#Done&quot; class=&quot;headerlink&quot; title=&quot;Done!&quot;&gt;&lt;/a&gt;Done!&lt;/h2&gt;&lt;p&gt;想像一下，Redux 就是個超級狀態機，藉由我們定義的 action 去改變 state。而我們只用了 Redux 提供的 &lt;code&gt;createStore()&lt;/code&gt; 產生 store，API 相當簡單。上面的程式我放在 &lt;a href=&quot;http://jsbin.com/conezo/edit?js,console&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;jsbin&lt;/a&gt; 上，點右上角的 run 即可看執行的結果。搞懂基本概念後，接著可以去查看&lt;a href=&quot;http://rackt.org/redux/docs/basics/Actions.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;官方文件的 Todo Example&lt;/a&gt;，或是 Redux 的 Creator &lt;a href=&quot;https://github.com/gaearon&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Dan Abramov&lt;/a&gt; 在 egghead 上的&lt;a href=&quot;https://egghead.io/lessons/javascript-redux-the-single-immutable-state-tree?series=getting-started-with-redux&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;影片教學&lt;/a&gt;。&lt;/p&gt;
&lt;h2 id=&quot;References&quot;&gt;&lt;a href=&quot;#References&quot; class=&quot;headerlink&quot; title=&quot;References&quot;&gt;&lt;/a&gt;References&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://rackt.org/redux/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://rackt.org/redux/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;真正開始寫 &lt;a href=&quot;https://facebook.github.io/react/&quot;&gt;React&lt;/a&gt; 大概是這一兩個月的時間吧，印象中前幾個月正火紅的時候，觀望著開發架構，從 Facebook 剛開始的 &lt;a href=&quot;https://github.com/facebook/flux&quot;&gt;Flux&lt;/a&gt;，一路看到 &lt;a href=&quot;https://github.com/BinaryMuse/fluxxor&quot;&gt;fluxxor&lt;/a&gt;、&lt;a href=&quot;https://github.com/goatslacker/alt&quot;&gt;alt&lt;/a&gt; 這些 Library 等等，真的是多到爆，然後那個 Flux 的概念圖看了不下 N 次，但還是不得其門而入。&lt;/p&gt;
&lt;p&gt;直到不久前出現了一個叫 &lt;a href=&quot;github.com/rackt/redux&quot;&gt;Redux&lt;/a&gt; 的東西，剛好有新 project 要用 React 寫，看著各方大神推薦就順勢跳進 Redux 的世界了。最近也利用 Redux 寫了個 &lt;a href=&quot;https://github.com/jigsawye/node-proxy-manager-client&quot;&gt;Proxy manager&lt;/a&gt;，趁最近期中考完，回頭寫一下 Redux 的核心概念。&lt;/p&gt;
    
    </summary>
    
      <category term="tutorial" scheme="http://jigsawye.com/categories/tutorial/"/>
    
    
      <category term="react" scheme="http://jigsawye.com/tags/react/"/>
    
      <category term="javascript" scheme="http://jigsawye.com/tags/javascript/"/>
    
      <category term="redux" scheme="http://jigsawye.com/tags/redux/"/>
    
  </entry>
  
  <entry>
    <title>在 Sublime Text 的 JSX 中使用 Emmet</title>
    <link href="http://jigsawye.com/2015/11/23/enable-emmet-for-jsx-in-sublime/"/>
    <id>http://jigsawye.com/2015/11/23/enable-emmet-for-jsx-in-sublime/</id>
    <published>2015-11-23T07:45:20.000Z</published>
    <updated>2016-01-18T12:00:07.000Z</updated>
    
    <content type="html">&lt;p&gt;Sublime Text 除了有內建的標籤自動補齊，最有名的 pakcage 就是 &lt;a href=&quot;http://emmet.io/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Emmet&lt;/a&gt; 了。Emmet 一直以來是寫 HTML 的神器，除了原本支援 HTML 外，其實已經支援了 JSX。但在 Sublime Text 的 JSX 中不額外設定的話是無法正常使用的，其實只要修改一下 Key Binding 就可以了。&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h2 id=&quot;安裝&quot;&gt;&lt;a href=&quot;#安裝&quot; class=&quot;headerlink&quot; title=&quot;安裝&quot;&gt;&lt;/a&gt;安裝&lt;/h2&gt;&lt;p&gt;如果你沒有安裝 Emmet，請先進行&lt;a href=&quot;https://github.com/sergeche/emmet-sublime#how-to-install&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;安裝&lt;/a&gt;。&lt;/p&gt;
&lt;h2 id=&quot;設定&quot;&gt;&lt;a href=&quot;#設定&quot; class=&quot;headerlink&quot; title=&quot;設定&quot;&gt;&lt;/a&gt;設定&lt;/h2&gt;&lt;p&gt;打開 &lt;code&gt;Sublime Text&lt;/code&gt; -&amp;gt; &lt;code&gt;Preferences&lt;/code&gt; -&amp;gt; &lt;code&gt;Key Bindings - User&lt;/code&gt;，增加以下：&lt;br&gt;&lt;figure class=&quot;highlight json&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attr&quot;&gt;&quot;keys&quot;&lt;/span&gt;: [&lt;span class=&quot;string&quot;&gt;&quot;tab&quot;&lt;/span&gt;], &lt;span class=&quot;attr&quot;&gt;&quot;command&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;expand_abbreviation_by_tab&quot;&lt;/span&gt;, &lt;span class=&quot;attr&quot;&gt;&quot;context&quot;&lt;/span&gt;: [&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#123; &lt;span class=&quot;attr&quot;&gt;&quot;operand&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;source.js&quot;&lt;/span&gt;, &lt;span class=&quot;attr&quot;&gt;&quot;operator&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;equal&quot;&lt;/span&gt;, &lt;span class=&quot;attr&quot;&gt;&quot;match_all&quot;&lt;/span&gt;: &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;, &lt;span class=&quot;attr&quot;&gt;&quot;key&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;selector&quot;&lt;/span&gt; &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#123; &lt;span class=&quot;attr&quot;&gt;&quot;match_all&quot;&lt;/span&gt;: &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;, &lt;span class=&quot;attr&quot;&gt;&quot;key&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;selection_empty&quot;&lt;/span&gt; &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#123; &lt;span class=&quot;attr&quot;&gt;&quot;operator&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;equal&quot;&lt;/span&gt;, &lt;span class=&quot;attr&quot;&gt;&quot;operand&quot;&lt;/span&gt;: &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;, &lt;span class=&quot;attr&quot;&gt;&quot;match_all&quot;&lt;/span&gt;: &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;, &lt;span class=&quot;attr&quot;&gt;&quot;key&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;has_next_field&quot;&lt;/span&gt; &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#123; &lt;span class=&quot;attr&quot;&gt;&quot;operand&quot;&lt;/span&gt;: &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;, &lt;span class=&quot;attr&quot;&gt;&quot;operator&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;equal&quot;&lt;/span&gt;, &lt;span class=&quot;attr&quot;&gt;&quot;match_all&quot;&lt;/span&gt;: &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;, &lt;span class=&quot;attr&quot;&gt;&quot;key&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;auto_complete_visible&quot;&lt;/span&gt; &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#123; &lt;span class=&quot;attr&quot;&gt;&quot;match_all&quot;&lt;/span&gt;: &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;, &lt;span class=&quot;attr&quot;&gt;&quot;key&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;is_abbreviation&quot;&lt;/span&gt; &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    ]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h2 id=&quot;Demo&quot;&gt;&lt;a href=&quot;#Demo&quot; class=&quot;headerlink&quot; title=&quot;Demo&quot;&gt;&lt;/a&gt;Demo&lt;/h2&gt;&lt;p&gt;當然，在 JSX 中的 Emmet 也會自動使用 &lt;code&gt;className&lt;/code&gt; 替代 &lt;code&gt;class&lt;/code&gt;，&lt;code&gt;htmlFor&lt;/code&gt; 替代 &lt;code&gt;for&lt;/code&gt; ⋯⋯等等的 JSX 語法。&lt;/p&gt;
&lt;img src=&quot;/2015/11/23/enable-emmet-for-jsx-in-sublime/demo.gif&quot; alt=&quot;demo.gif&quot; title=&quot;&quot;&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;Sublime Text 除了有內建的標籤自動補齊，最有名的 pakcage 就是 &lt;a href=&quot;http://emmet.io/&quot;&gt;Emmet&lt;/a&gt; 了。Emmet 一直以來是寫 HTML 的神器，除了原本支援 HTML 外，其實已經支援了 JSX。但在 Sublime Text 的 JSX 中不額外設定的話是無法正常使用的，其實只要修改一下 Key Binding 就可以了。&lt;/p&gt;
    
    </summary>
    
      <category term="note" scheme="http://jigsawye.com/categories/note/"/>
    
    
      <category term="react" scheme="http://jigsawye.com/tags/react/"/>
    
      <category term="jsx" scheme="http://jigsawye.com/tags/jsx/"/>
    
      <category term="sublime" scheme="http://jigsawye.com/tags/sublime/"/>
    
  </entry>
  
  <entry>
    <title>在 Mac 上使用 Homebrew 安裝 Docker</title>
    <link href="http://jigsawye.com/2015/10/10/install-docker-on-mac-via-homebrew/"/>
    <id>http://jigsawye.com/2015/10/10/install-docker-on-mac-via-homebrew/</id>
    <published>2015-10-09T18:01:40.000Z</published>
    <updated>2015-11-30T18:05:36.000Z</updated>
    
    <content type="html">&lt;blockquote&gt;
&lt;p&gt;本文建議了解 unix-like 基礎指令及 Docker 基本操作者閱讀。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;雖然 Docker 官方推薦使用 &lt;a href=&quot;https://www.docker.com/toolbox&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Docker Toolbox&lt;/a&gt;，不過我個人很不喜歡這種一鍵安裝包，連啟動還要用 GUI。可是動手搜尋 &lt;code&gt;docker via homebrew&lt;/code&gt; 之類的關鍵字，出來的結果都是使用舊的 &lt;code&gt;boot2docker&lt;/code&gt;（目前為 &lt;code&gt;docker-machine&lt;/code&gt;），所以找不到只好自己做個紀錄了。&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;!-- toc --&gt;
&lt;h2 id=&quot;安裝及設定&quot;&gt;&lt;a href=&quot;#安裝及設定&quot; class=&quot;headerlink&quot; title=&quot;安裝及設定&quot;&gt;&lt;/a&gt;安裝及設定&lt;/h2&gt;&lt;h3 id=&quot;安裝-docker-及-docker-machine&quot;&gt;&lt;a href=&quot;#安裝-docker-及-docker-machine&quot; class=&quot;headerlink&quot; title=&quot;安裝 docker 及 docker-machine&quot;&gt;&lt;/a&gt;安裝 docker 及 docker-machine&lt;/h3&gt;&lt;p&gt;首先更新 &lt;code&gt;homebrew&lt;/code&gt;：&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;❯ brew update&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;接著先安裝 &lt;code&gt;docker&lt;/code&gt; 及 &lt;code&gt;docker-machine&lt;/code&gt;：&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;❯ brew install docker docker-machine&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h3 id=&quot;啟動-docker-machine&quot;&gt;&lt;a href=&quot;#啟動-docker-machine&quot; class=&quot;headerlink&quot; title=&quot;啟動 docker-machine&quot;&gt;&lt;/a&gt;啟動 docker-machine&lt;/h3&gt;&lt;p&gt;我們要透過 &lt;code&gt;docker-machine&lt;/code&gt; 建立並啟動一個 VM 作為 docker 的環境，這邊我使用的 driver 為 VirtualBox，名字設定為 default：&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;❯ docker-machine create --driver virtualbox default&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;接下來為重點，我們執行 &lt;code&gt;docker-machine env default&lt;/code&gt;，可以查看 &lt;code&gt;default&lt;/code&gt; 所設定的參數，而這些參數用於指定 &lt;code&gt;docker&lt;/code&gt; 的 client 所要連線的參數：&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;❯ docker-machine env default&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;export&lt;/span&gt; DOCKER_TLS_VERIFY=&lt;span class=&quot;string&quot;&gt;&quot;1&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;export&lt;/span&gt; DOCKER_HOST=&lt;span class=&quot;string&quot;&gt;&quot;tcp://192.168.99.100:2376&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;export&lt;/span&gt; DOCKER_CERT_PATH=&lt;span class=&quot;string&quot;&gt;&quot;/Users/jigsawye/.docker/machine/machines/default&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;export&lt;/span&gt; DOCKER_MACHINE_NAME=&lt;span class=&quot;string&quot;&gt;&quot;default&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# Run this command to configure your shell:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# eval &quot;$(docker-machine env default)&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;在最後一行有提示 &lt;code&gt;Run this command to configure your shell&lt;/code&gt;，所以我們直接在 terminal 執行，用於參數設定至 shell 中：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;❯ &lt;span class=&quot;built_in&quot;&gt;eval&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;variable&quot;&gt;$(docker-machine env default)&lt;/span&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;不過這樣的話每次開新的 terminal 都要執行一次，所以你可以把這行指令新增到你的 &lt;code&gt;~/.bashrc&lt;/code&gt;（or &lt;code&gt;~/.zshrc&lt;/code&gt; etc）：&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;figcaption&gt;&lt;span&gt;.zshrc&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;...&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# configure the shell&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;eval&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;variable&quot;&gt;$(docker-machine env default)&lt;/span&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;...&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h2 id=&quot;Enjoy&quot;&gt;&lt;a href=&quot;#Enjoy&quot; class=&quot;headerlink&quot; title=&quot;Enjoy!&quot;&gt;&lt;/a&gt;Enjoy!&lt;/h2&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;❯ docker images&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;REPOSITORY        TAG        IMAGE ID        CREATED        VIRTUAL SIZE&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;故障排除&quot;&gt;&lt;a href=&quot;#故障排除&quot; class=&quot;headerlink&quot; title=&quot;故障排除&quot;&gt;&lt;/a&gt;故障排除&lt;/h2&gt;&lt;p&gt;如果沒執行 &lt;code&gt;eval &amp;quot;$(docker-machine env default)&amp;quot;&lt;/code&gt; 設定 &lt;code&gt;docker&lt;/code&gt; clinet 需要的參數，在執行指令時會顯示錯誤：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;❯ docker images&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Get http://%2Fvar%2Frun%2Fdocker.sock/v1.20/containers/json: dial unix /var/run/docker.sock: connect: no such file or directory.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;* Are you trying to connect to a TLS-enabled daemon without TLS?&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;* Is your docker daemon up and running?&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;Reference&quot;&gt;&lt;a href=&quot;#Reference&quot; class=&quot;headerlink&quot; title=&quot;Reference&quot;&gt;&lt;/a&gt;&lt;a href=&quot;https://docs.docker.com/installation/mac/#from-your-shell&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Reference&lt;/a&gt;&lt;/h2&gt;</content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;本文建議了解 unix-like 基礎指令及 Docker 基本操作者閱讀。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;雖然 Docker 官方推薦使用 &lt;a href=&quot;https://www.docker.com/toolbox&quot;&gt;Docker Toolbox&lt;/a&gt;，不過我個人很不喜歡這種一鍵安裝包，連啟動還要用 GUI。可是動手搜尋 &lt;code&gt;docker via homebrew&lt;/code&gt; 之類的關鍵字，出來的結果都是使用舊的 &lt;code&gt;boot2docker&lt;/code&gt;（目前為 &lt;code&gt;docker-machine&lt;/code&gt;），所以找不到只好自己做個紀錄了。&lt;/p&gt;
    
    </summary>
    
      <category term="note" scheme="http://jigsawye.com/categories/note/"/>
    
    
      <category term="docker" scheme="http://jigsawye.com/tags/docker/"/>
    
      <category term="terminal" scheme="http://jigsawye.com/tags/terminal/"/>
    
  </entry>
  
  <entry>
    <title>JSDC 2015 會後筆記（Day 2）</title>
    <link href="http://jigsawye.com/2015/10/07/jsdc-2015-day-2/"/>
    <id>http://jigsawye.com/2015/10/07/jsdc-2015-day-2/</id>
    <published>2015-10-07T03:23:00.000Z</published>
    <updated>2016-01-18T12:01:29.000Z</updated>
    
    <content type="html">&lt;blockquote&gt;
&lt;p&gt;本文延續 &lt;a href=&quot;/2015/10/05/jsdc-2015-day-1/&quot;&gt;Day 1&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;第一天結束之後，晚上我去淡水我朋友借住一天。淡水跟南港展覽館格有夠遠…來回要一個小時多，所以二天早上八點出發，到會場已經九點半了，導致我第一個 topic 完全沒聽到，虧大了！&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h2 id=&quot;Day-2&quot;&gt;&lt;a href=&quot;#Day-2&quot; class=&quot;headerlink&quot; title=&quot;Day 2&quot;&gt;&lt;/a&gt;Day 2&lt;/h2&gt;&lt;h3 id=&quot;Tooling-with-Three-js&quot;&gt;&lt;a href=&quot;#Tooling-with-Three-js&quot; class=&quot;headerlink&quot; title=&quot;Tooling with Three.js&quot;&gt;&lt;/a&gt;Tooling with Three.js&lt;/h3&gt;&lt;p&gt;如上文，這個 topic 我完全沒聽到…。不過看了一下簡報，&lt;code&gt;Three.js&lt;/code&gt; 是用來做 WebGL 的 JavaScript Library，可以用來做 Web 的 Game、Animation…等等，本身也有很多的開發工具可以用，在 Github 上也有 20000+ 的 Star，是相當成熟的 Library，未來有機會也許會試著接觸看看！&lt;/p&gt;
&lt;h3 id=&quot;Build-Anything-with-JavaScript&quot;&gt;&lt;a href=&quot;#Build-Anything-with-JavaScript&quot; class=&quot;headerlink&quot; title=&quot;Build Anything with JavaScript&quot;&gt;&lt;/a&gt;Build Anything with JavaScript&lt;/h3&gt;&lt;p&gt;講者主要介紹 Arduino 及相關的 IoT 設備，最後則講到他們開發的 Webduino。可能是因為前一天看過超 OP 的自幹 CNC 機器，所以在這場相對的沒有那麼讓我感到特別。基本上 Webduino 就是讓 Arduino 可以透過 HTML + JavaScript 的方式做開發，讓前端工程師也能享受操縱 IoT 的快感！不過比較可惜的是，因為當天網路環境相當惡劣，所以有些東西沒有 Demo，滿可惜的。&lt;/p&gt;
&lt;h3 id=&quot;React-Native-實戰-融入現有-iOS-App&quot;&gt;&lt;a href=&quot;#React-Native-實戰-融入現有-iOS-App&quot; class=&quot;headerlink&quot; title=&quot;React Native 實戰! 融入現有 iOS App&quot;&gt;&lt;/a&gt;React Native 實戰! 融入現有 iOS App&lt;/h3&gt;&lt;p&gt;使用 React Native 可以開發 native 的 app，但也可以結合至原有的 native app！講者先說明 React Native 的運作原理後，在講述自己將 React Native 整合至原本 native app 中。&lt;/p&gt;
&lt;p&gt;React Native 運作原理：&lt;br&gt;&lt;img src=&quot;/2015/10/07/jsdc-2015-day-2/01.png&quot; alt=&quot;01.png&quot; title=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;Demo 的時候講者在修改程式碼時，iOS app 也會跟著 live reloading，相當厲害！而且同樣的程式碼也能同時應用在 Android app！不過講者有提到，如果要銜接原生 app 的功能的話，必須會寫 Objective-C / Java 的原生 app，所以講者一直提到他叫原廠幫他修改原生的地方XD。&lt;/p&gt;
&lt;p&gt;個人覺得 React 開始在侵略整個世界了，等到未來趨近於穩定的時候，一定會有更多人投入這部分的開發，畢竟 React 的初衷就是：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Learn once, write anywhere.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;會了 React，可以同時開發 Web 及 App，何樂而不為呢XD&lt;/p&gt;
&lt;h3 id=&quot;Workshop-on-Control-Flow-w-ES2015-and-beyond&quot;&gt;&lt;a href=&quot;#Workshop-on-Control-Flow-w-ES2015-and-beyond&quot; class=&quot;headerlink&quot; title=&quot;Workshop on Control Flow w/ ES2015 and beyond.&quot;&gt;&lt;/a&gt;Workshop on Control Flow w/ ES2015 and beyond.&lt;/h3&gt;&lt;p&gt;講者是 &lt;a href=&quot;https://github.com/koajs/koa&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;koa.js&lt;/a&gt; 及 &lt;a href=&quot;https://github.com/tj/co&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;co&lt;/a&gt; 的作者 &lt;a href=&quot;https://github.com/jonathanong&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Jonathon&lt;/a&gt;，講題是在說 ES2015 的控制流程，主要都是在講 JavaScript 的非同步機制及解決方法。講者很細心整理了在開發 node.js 時常遇到的一些問題，跟對應的解決方案，最讓我感興趣的就是 ES2016 的 &lt;code&gt;async&lt;/code&gt; 及 &lt;code&gt;await&lt;/code&gt;，但是現在好像沒有很完整的實作。在簡報結束後時間好像剩我滿多的，所以都變成 Q&amp;amp;A 的時間，會眾問了不少問題，然後從講者身上挖到不少經驗及常用的工具或套件XD，我覺得最好笑的就是有個會眾問：&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;Q:「Do you have any good way to determine a callback function is a asynchronous callback?」&lt;/p&gt;
&lt;p&gt;「No. It sucks!」&lt;/p&gt;
&lt;footer&gt;&lt;strong&gt;Jonathon&lt;/strong&gt;&lt;cite&gt;JSDC 2015&lt;/cite&gt;&lt;/footer&gt;&lt;/blockquote&gt;
&lt;h3 id=&quot;Building-Hybrid-Mobile-Apps-with-Ionic-Framework-and-AngularJS&quot;&gt;&lt;a href=&quot;#Building-Hybrid-Mobile-Apps-with-Ionic-Framework-and-AngularJS&quot; class=&quot;headerlink&quot; title=&quot;Building Hybrid Mobile Apps with Ionic Framework and AngularJS&quot;&gt;&lt;/a&gt;Building Hybrid Mobile Apps with Ionic Framework and AngularJS&lt;/h3&gt;&lt;p&gt;其實這場只是因為想聽下場的講題，怕去 R2 回來就沒位置了，所以都在做自己的事XD。以前我寫過 AngularJS 一陣子，後來發現 React 後就轉投入 React 的懷抱了。其實在 React Native 或 NativeScript 等等，用於產生 native app 的作法前，使用 AngularJS 這種框架來建立 Hybrid app 是其中一種使用非原生語言開發 app 主流，使用 codova（PhoneGap）或是 ionic 來建立。&lt;/p&gt;
&lt;p&gt;但是這種作法一直令人詬病的就是效能問題，因為基底就是 Web，而行動裝置的效能本身就不如一般的電腦，所以在使用上的 UX 相當的不好。但是講者有提到目前的行動裝置效能日漸提升，或許未來也會有 Hybrid app 的一片天呢。&lt;/p&gt;
&lt;h3 id=&quot;React-Test-and-Material-Design-Lite-React？&quot;&gt;&lt;a href=&quot;#React-Test-and-Material-Design-Lite-React？&quot; class=&quot;headerlink&quot; title=&quot;React Test and Material Design Lite + React？&quot;&gt;&lt;/a&gt;React Test and Material Design Lite + React？&lt;/h3&gt;&lt;p&gt;講者 xpsteven 之前在 React.tw 發佈他們的 mdl-react 的時候我就關注他了XD，感覺是個思維相當新的人。在這個 topic 他分享了測試的辛酸史，前前後後失敗了四次之有，跟國父革命有得拼！講者的結論就是直接做 UI 的 E2E test 就好，還有能花「錢」解決就花下去，效益比較好，接著最後就做了 live demo。&lt;/p&gt;
&lt;p&gt;其實我一直在 Unit test 跟 E2E test 間做比較，我個人認為 Unit test 是首要完成的測試，因為 E2E test 是在測試的頂層，一般來說會比 Unit test 難處理，不過講者的結論也讓我想想是不是有這麼一回事，或許 E2E 才是會好解決的測試方案呢XD。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://2.bp.blogspot.com/-X__Rsznxdg4/TzPVWfte5ZI/AAAAAAAAAD0/Y1dWLNEW4zI/s1600/img1.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;最後獻上講者的上班攻防經驗：&lt;br&gt;&lt;blockquote&gt;&lt;p&gt;寫測試是一種防禦，避免同事做的蠢事害自己加班。&lt;br&gt;提交 Bug Issue 是一種攻擊，讓同事加班 LOL。&lt;/p&gt;
&lt;footer&gt;&lt;strong&gt;Xpsteven&lt;/strong&gt;&lt;cite&gt;JSDC 2015&lt;/cite&gt;&lt;/footer&gt;&lt;/blockquote&gt;&lt;/p&gt;
&lt;h2 id=&quot;Lighting-Talk&quot;&gt;&lt;a href=&quot;#Lighting-Talk&quot; class=&quot;headerlink&quot; title=&quot;Lighting Talk&quot;&gt;&lt;/a&gt;Lighting Talk&lt;/h2&gt;&lt;p&gt;印象最深刻的就是&lt;a href=&quot;https://chrome.google.com/webstore/detail/%E9%84%89%E6%B0%91%E6%9F%A5%E6%B0%B4%E8%A1%A8/kdcgipkhkbeipbooplfcdgclhecfngfi?hl=zh-TW&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;鄉民查水表&lt;/a&gt;跟 &lt;a href=&quot;http://mrt.express/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;MRT Express&lt;/a&gt;，後者還說他達成了大台北捷運1XX站抵達的成就XD。&lt;/p&gt;
&lt;h2 id=&quot;後記&quot;&gt;&lt;a href=&quot;#後記&quot; class=&quot;headerlink&quot; title=&quot;後記&quot;&gt;&lt;/a&gt;後記&lt;/h2&gt;&lt;p&gt;今年要參加的時候發現票價真的不是我這學生負擔得起的，不過還好 JSDC 有提供&lt;a href=&quot;http://jsdc-tw.kktix.cc/events/jsdc2015s&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;學生獎勵計畫&lt;/a&gt;，運氣很好也拿到資格。這也是我今年參加的第二個 Conference，上一次則是 COSCUP。參加這種 Conference 好處就是可以聽到很多技術的新知，也有在業界的開發經驗。以學生的角度真的可以學到不少未來工作的技能，而且我本身也很喜歡接觸新技術，所以即使很累我也覺得很值得啊！&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;本文延續 &lt;a href=&quot;/2015/10/05/jsdc-2015-day-1/&quot;&gt;Day 1&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;第一天結束之後，晚上我去淡水我朋友借住一天。淡水跟南港展覽館格有夠遠…來回要一個小時多，所以二天早上八點出發，到會場已經九點半了，導致我第一個 topic 完全沒聽到，虧大了！&lt;/p&gt;
    
    </summary>
    
      <category term="life" scheme="http://jigsawye.com/categories/life/"/>
    
    
      <category term="jsdc-2015" scheme="http://jigsawye.com/tags/jsdc-2015/"/>
    
      <category term="jsdc" scheme="http://jigsawye.com/tags/jsdc/"/>
    
      <category term="conference" scheme="http://jigsawye.com/tags/conference/"/>
    
  </entry>
  
  <entry>
    <title>JavaScript 的 Object.assign 陷阱</title>
    <link href="http://jigsawye.com/2015/10/06/javascript-object-assign/"/>
    <id>http://jigsawye.com/2015/10/06/javascript-object-assign/</id>
    <published>2015-10-06T10:05:14.000Z</published>
    <updated>2015-10-06T10:51:08.000Z</updated>
    
    <content type="html">&lt;blockquote&gt;
&lt;p&gt;以下開發情境為 ES2015（ES6）&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;一般在寫 React 的時候，通常會希望資料是 immutable（不可變的），讓開發時對資料的流向即處理更容易，所以通常會使用 &lt;code&gt;Object.assign&lt;/code&gt; 來複制 object。但今天在寫時遇到一個問題，我一直以為 &lt;code&gt;Object.assign&lt;/code&gt; 會連同子項目都複製，結果兩個不同的資料改 A 竟然連 B 都跟著動，就做個紀錄。&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;p&gt;假設我們有個 object，接著透過 &lt;code&gt;Object.assign&lt;/code&gt; 複製兩個 object：&lt;br&gt;&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; test = &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  childrenKey: &lt;span class=&quot;string&quot;&gt;&#39;value&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  childrenObject: &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    keyA: &lt;span class=&quot;string&quot;&gt;&#39;value a&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    keyB: &lt;span class=&quot;string&quot;&gt;&#39;value b&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; cloneA = &lt;span class=&quot;built_in&quot;&gt;Object&lt;/span&gt;.assign(&amp;#123;&amp;#125;, test);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; cloneB = &lt;span class=&quot;built_in&quot;&gt;Object&lt;/span&gt;.assign(&amp;#123;&amp;#125;, test);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;改變 &lt;code&gt;cloneA&lt;/code&gt; 中 &lt;code&gt;childrenKey&lt;/code&gt; 的 value，&lt;code&gt;cloneB&lt;/code&gt; 中 &lt;code&gt;childrenKey&lt;/code&gt; 的 value 並不會被改變：&lt;br&gt;&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;cloneA.childrenKey = &lt;span class=&quot;string&quot;&gt;&#39;change value&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// cloneA&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  childrenKey: &lt;span class=&quot;string&quot;&gt;&#39;change value&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  childrenObject: &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    keyA: &lt;span class=&quot;string&quot;&gt;&#39;value a&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    keyB: &lt;span class=&quot;string&quot;&gt;&#39;value b&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// cloneB&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  childrenKey: &lt;span class=&quot;string&quot;&gt;&#39;value&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  childrenObject: &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    keyA: &lt;span class=&quot;string&quot;&gt;&#39;value a&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    keyB: &lt;span class=&quot;string&quot;&gt;&#39;value b&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;可是當改變 &lt;code&gt;childrenObject&lt;/code&gt; 的值時，卻會連動改變：&lt;br&gt;&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;cloneA.childrenObject.keyA = &lt;span class=&quot;string&quot;&gt;&#39;change value a&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// cloneA&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  childrenKey: &lt;span class=&quot;string&quot;&gt;&#39;change value&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  childrenObject: &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    keyA: &lt;span class=&quot;string&quot;&gt;&#39;change value a&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    keyB: &lt;span class=&quot;string&quot;&gt;&#39;value b&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// cloneB&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  childrenKey: &lt;span class=&quot;string&quot;&gt;&#39;value&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  childrenObject: &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    keyA: &lt;span class=&quot;string&quot;&gt;&#39;change value a&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    keyB: &lt;span class=&quot;string&quot;&gt;&#39;value b&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;原因是 &lt;code&gt;Object.assign&lt;/code&gt; 只會對 object 的子項目做 clone，下一層的則會建立 reference，所以指向的 &lt;code&gt;childrenObject&lt;/code&gt; 會是同一個。&lt;br&gt;要解決這個問題的話可以使用 &lt;code&gt;lodash&lt;/code&gt; 的 &lt;code&gt;clonedeep&lt;/code&gt;：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; cloneDeep = &lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;lodash.clonedeep&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; test = &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  childrenKey: &lt;span class=&quot;string&quot;&gt;&#39;value&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  childrenObject: &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    keyA: &lt;span class=&quot;string&quot;&gt;&#39;value a&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    keyB: &lt;span class=&quot;string&quot;&gt;&#39;value b&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; cloneA = cloneDeep(test);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; cloneB = cloneDeep(test);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;或是使用 &lt;a href=&quot;https://facebook.github.io/immutable-js/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;immutable.js&lt;/a&gt;。&lt;/p&gt;
&lt;p&gt;reference: &lt;a href=&quot;http://boke.io/immutable-js/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;搞定immutable.js&lt;/a&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;以下開發情境為 ES2015（ES6）&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;一般在寫 React 的時候，通常會希望資料是 immutable（不可變的），讓開發時對資料的流向即處理更容易，所以通常會使用 &lt;code&gt;Object.assign&lt;/code&gt; 來複制 object。但今天在寫時遇到一個問題，我一直以為 &lt;code&gt;Object.assign&lt;/code&gt; 會連同子項目都複製，結果兩個不同的資料改 A 竟然連 B 都跟著動，就做個紀錄。&lt;/p&gt;
    
    </summary>
    
      <category term="note" scheme="http://jigsawye.com/categories/note/"/>
    
    
      <category term="javascript" scheme="http://jigsawye.com/tags/javascript/"/>
    
      <category term="trap" scheme="http://jigsawye.com/tags/trap/"/>
    
  </entry>
  
  <entry>
    <title>JSDC 2015 會後筆記（Day 1）</title>
    <link href="http://jigsawye.com/2015/10/05/jsdc-2015-day-1/"/>
    <id>http://jigsawye.com/2015/10/05/jsdc-2015-day-1/</id>
    <published>2015-10-05T05:32:21.000Z</published>
    <updated>2016-01-18T12:01:23.000Z</updated>
    
    <content type="html">&lt;p&gt;JSDC 全名是 JavaScript Developer Conference，是台灣所有 JavaScript 開發者的年度盛會。&lt;/p&gt;
&lt;p&gt;今年 JSDC 的 &lt;strong&gt;Build anything with JavaScript&lt;/strong&gt; 包含了 iOS App、Android App、Arduino…等等，涵蓋了各式各樣的議題，不僅僅侷限於 Web，會後也有 Lighting talk 這種有趣的活動，讓會眾也能參與議題分享，還有吃（X）。整體來說 JSDC 是每年吸收 JavaScript 新知的好活動。&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h2 id=&quot;Day-1&quot;&gt;&lt;a href=&quot;#Day-1&quot; class=&quot;headerlink&quot; title=&quot;Day 1&quot;&gt;&lt;/a&gt;Day 1&lt;/h2&gt;&lt;p&gt;第一天比較辛苦的就是活動在台北，而我人在台中，所以五點左右就起床準備搭車了，到了中研院也差不多快九點了。這裡就把我聽的幾場 topic 做簡單的紀錄。&lt;/p&gt;
&lt;h3 id=&quot;React-Navigation-System&quot;&gt;&lt;a href=&quot;#React-Navigation-System&quot; class=&quot;headerlink&quot; title=&quot;React Navigation System&quot;&gt;&lt;/a&gt;React Navigation System&lt;/h3&gt;&lt;p&gt;這場的講者是 Hedger，是 Facebook 的 React Native 開發者。主要在分享開發 facebook ads manager 所遇到的一些問題：因為 web 與 app 的 navigation 實作機制的不同，他們想解決這個問題，做出可以跨平台的 navigation。&lt;/p&gt;
&lt;p&gt;我理解無誤的話（說實話這場對我來說有點 high level，有些地方聽不太懂），他們自幹了一個在頂層的 navigation 來管理所有的 route，取代掉原生 App 的機制，不過因為剛開始投影機有點怪，所以簡報不清楚，我也沒看清楚他是如何實作的。&lt;/p&gt;
&lt;p&gt;在這場唯一理解到的就是，React Native 是個很厲害的技術，聽到他們將 App 由 iOS 移轉到 Android 上竟然 reuse 80% 的 Code，實在是很令人欽佩啊，有機會一定要實做看看。&lt;/p&gt;
&lt;h3 id=&quot;JavaScript-開發流程自動化懶人包&quot;&gt;&lt;a href=&quot;#JavaScript-開發流程自動化懶人包&quot; class=&quot;headerlink&quot; title=&quot;JavaScript 開發流程自動化懶人包&quot;&gt;&lt;/a&gt;JavaScript 開發流程自動化懶人包&lt;/h3&gt;&lt;p&gt;講者講述在開發 JavaScript 時的 workflow，其實有點像在介紹 DevOps 該做的事情。不過因為我自己也有在研究 DevOps 的相關技術，所以在聽時就比較像在複習一般。但是講者有提到很多沒用過的工具，當然就先把名字抄起來等日後有時間再研究啦。&lt;/p&gt;
&lt;h3 id=&quot;用JavaScript實現微電腦自動控制不是夢！&quot;&gt;&lt;a href=&quot;#用JavaScript實現微電腦自動控制不是夢！&quot; class=&quot;headerlink&quot; title=&quot;用JavaScript實現微電腦自動控制不是夢！&quot;&gt;&lt;/a&gt;用JavaScript實現微電腦自動控制不是夢！&lt;/h3&gt;&lt;p&gt;只能說這講者太猛了，前面在講 JavaScript 與 Arduino，使用哪些 Library，實作 Led、Motor、Servo…等等，這些其實都不新奇，剛開始還覺得怎麼在分享這麼稀鬆平常的東西。接著講到機械手臂時我倒覺得滿厲害的！沒想到接下來的東西真的讓我跪在會場了…他花了三個月的時間自幹了一台 CNC 機器（沒錯，從零開始自己買零件組裝），還自幹了 Web UI 來控制（&lt;a href=&quot;https://github.com/cheton/cnc.js&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;cnc.js&lt;/a&gt;）。最讓我佩服的是，他是一個 F2E Developer，竟然在做 Maker 做的事，整體完成度還相當高。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://cheton.github.io/jsdc2015/images/demo/cnc/cnc-sample-sanding.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;div class=&quot;video-container&quot;&gt;&lt;iframe src=&quot;//www.youtube.com/embed/fJyq4fyiGSc&quot; frameborder=&quot;0&quot; allowfullscreen&gt;&lt;/iframe&gt;&lt;/div&gt;
&lt;h3 id=&quot;Building-Single-Page-Apps-with-Aurelia&quot;&gt;&lt;a href=&quot;#Building-Single-Page-Apps-with-Aurelia&quot; class=&quot;headerlink&quot; title=&quot;Building Single-Page Apps with Aurelia&quot;&gt;&lt;/a&gt;Building Single-Page Apps with Aurelia&lt;/h3&gt;&lt;p&gt;這場請到 &lt;a href=&quot;http://aurelia.io/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Aurelia&lt;/a&gt; 的 contributor &lt;a href=&quot;https://github.com/davismj&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Matt&lt;/a&gt; 分享 SPA（Single Page Application）與 Aurelia。開頭在講解 SPA 的一些眉眉角角，接著就介紹 Aurelia 及它的一些特性。&lt;/p&gt;
&lt;p&gt;其實之前就看過 Aurelia 這個 Framework，JavaScript 用到了 ES7（ES 2015），是相當前衛的 Framework，雖然自己沒有寫過，不過感覺未來會崛起，與 React 及 Angular 並行。&lt;/p&gt;
&lt;h3 id=&quot;技術演進的大亂鬥&quot;&gt;&lt;a href=&quot;#技術演進的大亂鬥&quot; class=&quot;headerlink&quot; title=&quot;技術演進的大亂鬥&quot;&gt;&lt;/a&gt;技術演進的大亂鬥&lt;/h3&gt;&lt;p&gt;基本上就是介紹目前 Front-end 在使用的一些技術，講題中大概 90% 都有聽過，所以沒有很難理解。只是有點感傷，前端技術真的不停的在轉換。&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;學 frontend 很倒霉（認同請分享）&lt;/p&gt;
&lt;footer&gt;&lt;strong&gt;Casear Chu&lt;/strong&gt;&lt;cite&gt;JSDC 2015&lt;/cite&gt;&lt;/footer&gt;&lt;/blockquote&gt;
&lt;img src=&quot;/2015/10/05/jsdc-2015-day-1/01.png&quot; alt=&quot;01.png&quot; title=&quot;&quot;&gt;
&lt;h3 id=&quot;Transducer&quot;&gt;&lt;a href=&quot;#Transducer&quot; class=&quot;headerlink&quot; title=&quot;Transducer&quot;&gt;&lt;/a&gt;Transducer&lt;/h3&gt;&lt;p&gt;慚愧啊…這場聽到睡著，從 mapreduce 之後都沒聽到，不過感覺滿像在上數學課的，當時位置也做很後面，看不太到簡報，滿累的一場。&lt;/p&gt;
&lt;h3 id=&quot;TDD-的開發哲學，以-nodejs-為例&quot;&gt;&lt;a href=&quot;#TDD-的開發哲學，以-nodejs-為例&quot; class=&quot;headerlink&quot; title=&quot;TDD 的開發哲學，以 nodejs 為例&quot;&gt;&lt;/a&gt;TDD 的開發哲學，以 nodejs 為例&lt;/h3&gt;&lt;p&gt;講者是在業界有開發多年經驗的開發者，目前擔任 leader，主要是在講述在開發時使用 TDD 的心法跟介紹。其實關於 test 我自己也有嘗試練習過，也看過很多文件跟心得，不過一直很難在實作中用上。&lt;/p&gt;
&lt;p&gt;結束後我問了講者幾個問題，主要是問怎麼將測試導入至專案中，其實在寫測試時最讓我困惑的大概就是寫出完整的測試程式，但是有些測試又不太好寫，講者給我的建議是：「由大功能好寫的測試先寫，再逐一切分功能寫測試」。所以目前正在研究 test 的部分，畢竟 test 的優點是在任何程式語言都能用到的技巧，只要學起來必定能在各個語言中如魚得水。&lt;/p&gt;
&lt;h3 id=&quot;Web-Components-amp-the-next-generation-ADs&quot;&gt;&lt;a href=&quot;#Web-Components-amp-the-next-generation-ADs&quot; class=&quot;headerlink&quot; title=&quot;Web Components &amp;amp; the next generation ADs&quot;&gt;&lt;/a&gt;Web Components &amp;amp; the next generation ADs&lt;/h3&gt;&lt;p&gt;這場根本是第一天的壓軸XD，太好笑了。講者 Paul 演講起很正經，可是又會穿插很好笑的梗！這場講的 Web Component 是個很厲害的技術，把 HTML5 都包裝成 Component，可以直接在 HTML 中使用，未來可能會成為主流，不過現在的&lt;a href=&quot;http://caniuse.com/#search=component&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;支援度&lt;/a&gt;實在是太差了，只有 Google Chrome 全數支援，期待未來幾年在其他瀏覽器中實作。接著講到 Web Component 在廣告中的應用，真的讓 UX 提升一定的級數，之後的 E2E Test Demo 也很驚艷，讓會眾都相當激動XD。&lt;/p&gt;
&lt;h3 id=&quot;Day-2&quot;&gt;&lt;a href=&quot;#Day-2&quot; class=&quot;headerlink&quot; title=&quot;Day 2&quot;&gt;&lt;/a&gt;&lt;a href=&quot;/2015/10/07/jsdc-2015-day-2/&quot;&gt;Day 2&lt;/a&gt;&lt;/h3&gt;</content>
    
    <summary type="html">
    
      &lt;p&gt;JSDC 全名是 JavaScript Developer Conference，是台灣所有 JavaScript 開發者的年度盛會。&lt;/p&gt;
&lt;p&gt;今年 JSDC 的 &lt;strong&gt;Build anything with JavaScript&lt;/strong&gt; 包含了 iOS App、Android App、Arduino…等等，涵蓋了各式各樣的議題，不僅僅侷限於 Web，會後也有 Lighting talk 這種有趣的活動，讓會眾也能參與議題分享，還有吃（X）。整體來說 JSDC 是每年吸收 JavaScript 新知的好活動。&lt;/p&gt;
    
    </summary>
    
      <category term="life" scheme="http://jigsawye.com/categories/life/"/>
    
    
      <category term="jsdc-2015" scheme="http://jigsawye.com/tags/jsdc-2015/"/>
    
      <category term="jsdc" scheme="http://jigsawye.com/tags/jsdc/"/>
    
      <category term="conference" scheme="http://jigsawye.com/tags/conference/"/>
    
  </entry>
  
  <entry>
    <title>使用 Docker 建置 Gitlab CE 的 Source Control 及 CI 環境</title>
    <link href="http://jigsawye.com/2015/09/25/gitlab-ce-in-docker/"/>
    <id>http://jigsawye.com/2015/09/25/gitlab-ce-in-docker/</id>
    <published>2015-09-25T11:23:30.000Z</published>
    <updated>2016-01-18T12:00:47.000Z</updated>
    
    <content type="html">&lt;blockquote&gt;
&lt;p&gt;本文建議了解 unix-like 基礎指令及 Docker 基本操作者閱讀。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;這幾天在我們的 imaclab 試著建置 CI 環境，順便就學了 Docker，發現 Docker 這東西真的非常方便，直接把環境都放進 container 裡，也不怕把環境搞爛。對環境建置的苦手真的是一番福音，網路上也很多關於 Docker 的文章，在這邊也不贅述了。&lt;br&gt;原本在架設的時候想使用 Gitlab + Jenkins，不過因專案的需求沒有需要 Jenkins 這麼開放客製化的 CI 工具（其實是我覺得很囉唆一堆東西要設定），剛好 Gitlab 也有提供 CI，需求上也符合，所以就決定使用 Gitlab + Gitlab CI。&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;!-- toc --&gt;
&lt;h2 id=&quot;Gitlab&quot;&gt;&lt;a href=&quot;#Gitlab&quot; class=&quot;headerlink&quot; title=&quot;Gitlab&quot;&gt;&lt;/a&gt;Gitlab&lt;/h2&gt;&lt;p&gt;以自行架設私有的版本控制環境來說，Gitlab 肯定是首選（因為我不知道還有哪些版控可以自己架），很久以前曾經自己在 ubuntu 上用官方提供的一鍵安裝包裝過一次，用過這種懶人包的都知道，裝的時候完全不知道發生什麼事，尤其當時還很菜。那時是成功架起來沒錯，不過完全不知道發生了什麼事。&lt;/p&gt;
&lt;h3 id=&quot;環境&quot;&gt;&lt;a href=&quot;#環境&quot; class=&quot;headerlink&quot; title=&quot;環境&quot;&gt;&lt;/a&gt;環境&lt;/h3&gt;&lt;p&gt;我是直接用了學長架的 OpenStack 叢集開一個 instance 當建置環境，基本上要照這份筆記安裝 Gitlab CE，應該只要隨便一個有裝 Docker 的 unix-like 系統都可以。&lt;/p&gt;
&lt;img src=&quot;/2015/09/25/gitlab-ce-in-docker/01.png&quot; alt=&quot;01.png&quot; title=&quot;&quot;&gt;
&lt;h3 id=&quot;安裝&quot;&gt;&lt;a href=&quot;#安裝&quot; class=&quot;headerlink&quot; title=&quot;安裝&quot;&gt;&lt;/a&gt;安裝&lt;/h3&gt;&lt;p&gt;透過 Docker 安裝 Gitlab CE 很簡單，只要在 &lt;a href=&quot;https://hub.docker.com&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Docker Hub&lt;/a&gt; 上找 gitlab 就可以找到很多的 images，我選了 star 最多的 &lt;a href=&quot;https://hub.docker.com/r/sameersbn/gitlab/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;sameersbn/gitlab&lt;/a&gt; ，基本上只要照 image 的文件做就可以了。&lt;/p&gt;
&lt;p&gt;首先將 &lt;code&gt;sameersbn/gitlab&lt;/code&gt; 的 image pull 下來。&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;docker pull sameersbn/gitlab:8.0.2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;接著有兩種方式可以啟動 Gitlab：最簡單的是使用 &lt;code&gt;docker-compose&lt;/code&gt;，透過設定檔啟動。另外就是手動執行 &lt;code&gt;docker run&lt;/code&gt; 指令將 gitlab 所需的 service 逐一啟動。這邊我選擇後者，因為我沒裝 docker-compose，未來有安裝在補充這部分的使用方式。&lt;/p&gt;
&lt;p&gt;除了 Gitlab 本身，他還需要額外啟用 &lt;code&gt;PostgreSQL&lt;/code&gt; 及 &lt;code&gt;Redis&lt;/code&gt; 的 servcie，基本上只要按照文件啟動 container 就可以了：&lt;/p&gt;
&lt;p&gt;啟動 PostgreSQL container：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;docker run --name gitlab-postgresql &lt;span class=&quot;_&quot;&gt;-d&lt;/span&gt; \&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    --env &lt;span class=&quot;string&quot;&gt;&#39;DB_NAME=gitlabhq_production&#39;&lt;/span&gt; \&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    --env &lt;span class=&quot;string&quot;&gt;&#39;DB_USER=gitlab&#39;&lt;/span&gt; --env &lt;span class=&quot;string&quot;&gt;&#39;DB_PASS=password&#39;&lt;/span&gt; \&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    --volume /srv/docker/gitlab/postgresql:/var/lib/postgresql \&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    sameersbn/postgresql:9.4-3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;啟動 Redis container：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;docker run --name gitlab-redis &lt;span class=&quot;_&quot;&gt;-d&lt;/span&gt; \&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    --volume /srv/docker/gitlab/redis:/var/lib/redis \&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    sameersbn/redis:latest&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;最後啟動 Gitlab container。這邊要注意我除了照原文件之外，還額外加上 &lt;code&gt;GITLAB_HOST&lt;/code&gt;，因為我的建置環境不在本機上，所以要加上該環境的 ip，否則 user 的大頭貼會是死圖。另外指令中的 &lt;code&gt;long-and-random-alpha-numeric-string&lt;/code&gt; 請替換成一組隨機字串，可以使用 &lt;code&gt;pwgen -Bsv1 64&lt;/code&gt; 來產生：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;docker run --name gitlab &lt;span class=&quot;_&quot;&gt;-d&lt;/span&gt; \&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    --link gitlab-postgresql:postgresql --link gitlab-redis:redisio \&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    --publish 10022:22 --publish 10080:80 \&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    --env &lt;span class=&quot;string&quot;&gt;&#39;GITLAB_HOST=your-gitlab-ip&#39;&lt;/span&gt; \&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    --env &lt;span class=&quot;string&quot;&gt;&#39;GITLAB_PORT=10080&#39;&lt;/span&gt; --env &lt;span class=&quot;string&quot;&gt;&#39;GITLAB_SSH_PORT=10022&#39;&lt;/span&gt; \&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    --env &lt;span class=&quot;string&quot;&gt;&#39;GITLAB_SECRETS_DB_KEY_BASE=long-and-random-alpha-numeric-string&#39;&lt;/span&gt; \&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    --volume /srv/docker/gitlab/gitlab:/home/git/data \&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    sameersbn/gitlab:8.0.2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;完成！&quot;&gt;&lt;a href=&quot;#完成！&quot; class=&quot;headerlink&quot; title=&quot;完成！&quot;&gt;&lt;/a&gt;完成！&lt;/h3&gt;&lt;img src=&quot;/2015/09/25/gitlab-ce-in-docker/02.png&quot; alt=&quot;02.png&quot; title=&quot;&quot;&gt;
&lt;p&gt;打開瀏覽器瀏覽 &lt;code&gt;http://your-gitlab-ip:10080&lt;/code&gt;，就可以看到 Gitlab 架設好了，輸入預設的帳號密碼就可以直接登入：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;username: &lt;strong&gt;root&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;password: &lt;strong&gt;5iveL!fe&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;Gitlab-CI&quot;&gt;&lt;a href=&quot;#Gitlab-CI&quot; class=&quot;headerlink&quot; title=&quot;Gitlab CI&quot;&gt;&lt;/a&gt;Gitlab CI&lt;/h2&gt;&lt;p&gt;這次安裝的時候原本第一天裝 Gitlab CE 7.14.3，Gitlab CI 還要另外做安裝，後來更新到 8.0.0 的時候 Gitlab 把 CI 整合進了 Gitlab CE 裡，所以只需要裝 Gitlab CE 就包含了 CI 的功能了！兩個願望一次滿足！&lt;/p&gt;
&lt;p&gt;以下以簡單的 Node.js project 為例，做一次完整的 CI Flow：&lt;/p&gt;
&lt;h3 id=&quot;建立-repository&quot;&gt;&lt;a href=&quot;#建立-repository&quot; class=&quot;headerlink&quot; title=&quot;建立 repository&quot;&gt;&lt;/a&gt;建立 repository&lt;/h3&gt;&lt;p&gt;首先在 Gitlab 上建立一個 &lt;code&gt;ci-flow&lt;/code&gt; 的 repository：&lt;/p&gt;
&lt;img src=&quot;/2015/09/25/gitlab-ce-in-docker/03.png&quot; alt=&quot;03.png&quot; title=&quot;&quot;&gt;
&lt;p&gt;接著點選 CI 選項，點選 &lt;strong&gt;Add project to CI&lt;/strong&gt; 將剛剛建立的 &lt;code&gt;ci-flow&lt;/code&gt; 加入至 CI 中：&lt;/p&gt;
&lt;img src=&quot;/2015/09/25/gitlab-ce-in-docker/04.png&quot; alt=&quot;04.png&quot; title=&quot;&quot;&gt;
&lt;p&gt;點選 runner 分頁，記下 url 及 token：&lt;/p&gt;
&lt;img src=&quot;/2015/09/25/gitlab-ce-in-docker/05.png&quot; alt=&quot;05.png&quot; title=&quot;&quot;&gt;
&lt;h3 id=&quot;gitlab-runner&quot;&gt;&lt;a href=&quot;#gitlab-runner&quot; class=&quot;headerlink&quot; title=&quot;gitlab-runner&quot;&gt;&lt;/a&gt;gitlab-runner&lt;/h3&gt;&lt;p&gt;什麼是 &lt;code&gt;gitlab-runner&lt;/code&gt; 呢？簡單來說就是透過這個 runner 去執行 CI 所要執行的工作。例如我以 docker 做測試環境，runner 會建立預先設定好 image 的 container，CI 被觸發時會自動 start 該 container，並把 repository pull 至 container 內，接著執行指定的動作。在這部分我們要安裝及設定 &lt;code&gt;gitlab-runner&lt;/code&gt;，並註冊讓它執行。&lt;/p&gt;
&lt;p&gt;透過 Docker 安裝 gitlab-runner，參考&lt;a href=&quot;https://gitlab.com/gitlab-org/gitlab-ci-multi-runner/blob/master/docs/install/docker.md&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;官方文件&lt;/a&gt;：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;docker run &lt;span class=&quot;_&quot;&gt;-d&lt;/span&gt; --name gitlab-runner --restart always \&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  -v /var/run/docker.sock:/var/run/docker.sock \&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  -v /srv/gitlab-runner/config:/etc/gitlab-runner \&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  gitlab/gitlab-runner:latest&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;執行 gitlab-runner 進行註冊，這邊的 url 及 token 就是剛剛 runner 分頁對應的資料。其餘部分根據需求做選擇，像我不需要 DB 的 Service 所以一律 enter 略過：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;docker &lt;span class=&quot;built_in&quot;&gt;exec&lt;/span&gt; -it gitlab-runner gitlab-runner register&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Please enter the gitlab-ci coordinator URL (e.g. https://gitlab.com/ci )&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;https://your-gitlab-ip:10080/ci&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Please enter the gitlab-ci token &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; this runner&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;your-gitlab-ci-token&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Please enter the gitlab-ci description &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; this runner&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[86598ea6394b]: node-4.1.1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;INFO[0034] 08cc0e60 Registering runner... succeeded&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Please enter the executor: docker, docker-ssh, ssh, shell, parallels:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[shell]: docker&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Please enter the Docker image (eg. ruby:2.1):&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;node:4.1.1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;If you want to &lt;span class=&quot;built_in&quot;&gt;enable&lt;/span&gt; mysql please enter version (X.Y) or enter latest?&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;If you want to &lt;span class=&quot;built_in&quot;&gt;enable&lt;/span&gt; postgres please enter version (X.Y) or enter latest?&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;If you want to &lt;span class=&quot;built_in&quot;&gt;enable&lt;/span&gt; redis please enter version (X.Y) or enter latest?&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;If you want to &lt;span class=&quot;built_in&quot;&gt;enable&lt;/span&gt; mongo please enter version (X.Y) or enter latest?&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;INFO[0045] Runner registered successfully. Feel free to start it, but &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; it&lt;span class=&quot;string&quot;&gt;&#39;s running already the config should be automatically reloaded!&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;現在前往 CI 的 runner 分頁應該就會看到 node-4.1.1 並且是 active 的。&lt;/p&gt;
&lt;img src=&quot;/2015/09/25/gitlab-ce-in-docker/06.png&quot; alt=&quot;06.png&quot; title=&quot;&quot;&gt;
&lt;blockquote&gt;
&lt;p&gt;注意，這邊我們要編輯 node-4.1.1 這個 runner，並增加名為 node-4.1.1 的 tag 讓 CI 能夠啟動對應的 runner。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;img src=&quot;/2015/09/25/gitlab-ce-in-docker/07.png&quot; alt=&quot;07.png&quot; title=&quot;&quot;&gt;
&lt;h3 id=&quot;建立-project&quot;&gt;&lt;a href=&quot;#建立-project&quot; class=&quot;headerlink&quot; title=&quot;建立 project&quot;&gt;&lt;/a&gt;建立 project&lt;/h3&gt;&lt;p&gt;建立一個 project，並使用 &lt;code&gt;npm init&lt;/code&gt;（enter 到底就可以了）產生 &lt;code&gt;package.json&lt;/code&gt;，接著安裝 node.js 的測試工具 &lt;code&gt;mocha&lt;/code&gt;：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;mkdir ci-flow&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;cd&lt;/span&gt; ci-flow&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;npm init&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;npm install mocha --save-dev&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;接著建立檔案 &lt;code&gt;test/test.js&lt;/code&gt; 並撰寫簡單的測試程式：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;figcaption&gt;&lt;span&gt;test/test.js&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; assert = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;assert&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;describe(&lt;span class=&quot;string&quot;&gt;&#39;Array&#39;&lt;/span&gt;, &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  describe(&lt;span class=&quot;string&quot;&gt;&#39;#indexOf()&#39;&lt;/span&gt;, &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    it(&lt;span class=&quot;string&quot;&gt;&#39;should return -1 when the value is not present&#39;&lt;/span&gt;, &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      assert.equal(&lt;span class=&quot;number&quot;&gt;-1&lt;/span&gt;, [&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;].indexOf(&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      assert.equal(&lt;span class=&quot;number&quot;&gt;-1&lt;/span&gt;, [&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;].indexOf(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;寫完測試當然要在 local 測試一下，直接執行 project 中安裝的 &lt;code&gt;./node_modules/mocha/bin/mocha&lt;/code&gt;：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ ./node_modules/mocha/bin/mocha&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  Array&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;#indexOf()&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      ✓ should &lt;span class=&quot;built_in&quot;&gt;return&lt;/span&gt; -1 when the value is not present&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  1 passing (9ms)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;測試成功！接著我們來設定 CI 所要使用的 image 及執行的 script。&lt;/p&gt;
&lt;h3 id=&quot;gitlab-ci-yml&quot;&gt;&lt;a href=&quot;#gitlab-ci-yml&quot; class=&quot;headerlink&quot; title=&quot;.gitlab-ci.yml&quot;&gt;&lt;/a&gt;.gitlab-ci.yml&lt;/h3&gt;&lt;p&gt;重點來了，我們要在專案的根目錄建立 &lt;code&gt;.gitlab-ci.yml&lt;/code&gt; 的檔案，用於決定 Gitlab CI 要如何對專案 build、test、deploy…等等，類似於 Travis CI 的 &lt;code&gt;.travis.yml&lt;/code&gt;。詳細的可用選項可以參考&lt;a href=&quot;http://doc.gitlab.com/ci/yaml/README.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;官方文件&lt;/a&gt;，這邊以我的例子做解說：&lt;br&gt;&lt;code&gt;before_script&lt;/code&gt; 是執行 job 前會執行的 script，我在這邊設定安裝 node 的 dependencies，也就是 &lt;code&gt;mocha&lt;/code&gt; 這個 test tool。&lt;code&gt;stages&lt;/code&gt; 為設定有幾種工作階段，一般可能就會有 &lt;code&gt;build&lt;/code&gt;、&lt;code&gt;test&lt;/code&gt;、&lt;code&gt;deploy&lt;/code&gt;，並按照順序逐一執行對應的 job，我這邊單獨以 &lt;code&gt;test&lt;/code&gt; 做例子。接著制定第一個 job，對應的就是 &lt;code&gt;test&lt;/code&gt; 這個 stage，在 &lt;code&gt;script&lt;/code&gt; 增加執行 project 內的 &lt;code&gt;mocha&lt;/code&gt; 做測試，並指在 &lt;code&gt;master&lt;/code&gt; 這個 branch，最後加上一個 &lt;code&gt;node-4.1.1&lt;/code&gt; 的 tag 去啟動對應 tag 為 &lt;code&gt;node-4.1.1&lt;/code&gt; 的 &lt;code&gt;gitlab-runner&lt;/code&gt;，因為一般在測試時可能會針對多個不同版本的環境做測試，所以會使用 tag 這個功能來做設定。&lt;/p&gt;
&lt;figure class=&quot;highlight ruby&quot;&gt;&lt;figcaption&gt;&lt;span&gt;.gitlab-ci.yml&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;symbol&quot;&gt;before_script:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  - npm install&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;symbol&quot;&gt;stages:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  - test&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;symbol&quot;&gt;job1:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;symbol&quot;&gt;stage:&lt;/span&gt; test&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;symbol&quot;&gt;script:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    - ./node_modules/mocha/bin/mocha&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;symbol&quot;&gt;only:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    - master&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;symbol&quot;&gt;tags:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    - node-&lt;span class=&quot;number&quot;&gt;4.1&lt;/span&gt;.&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;在版本控制上並不希望 &lt;code&gt;node_modules&lt;/code&gt; 放入版本控制中，所以增加 &lt;code&gt;.gitignore&lt;/code&gt; 檔案並排除該目錄：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;touch .gitignore&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;echo&lt;/span&gt; node_modules &amp;gt; .gitignore&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;加入版本控制：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;git init&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;git add .&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;git commit -m &lt;span class=&quot;string&quot;&gt;&#39;Test gitlab-ci with &amp;lt;3&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Push 至 Repository：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;git remote add origin your-project-repository&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;git push -u origin master&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;最後等待 CI 自動執行測試！&lt;/p&gt;
&lt;h3 id=&quot;執行結果&quot;&gt;&lt;a href=&quot;#執行結果&quot; class=&quot;headerlink&quot; title=&quot;執行結果&quot;&gt;&lt;/a&gt;執行結果&lt;/h3&gt;&lt;p&gt;Push 至 Repository 後可以在 CI 的 Dashboard 看見剛剛的 commit 已經 pending 了：&lt;/p&gt;
&lt;img src=&quot;/2015/09/25/gitlab-ce-in-docker/08.png&quot; alt=&quot;08.png&quot; title=&quot;&quot;&gt;
&lt;p&gt;點進去後可以看到目前須執行的所有 job，根據你的 &lt;code&gt;.gitlab-ci.yml&lt;/code&gt; 而定，一般來說會在多個環境測試，並包含 deploy 等多種不同的 job：&lt;/p&gt;
&lt;img src=&quot;/2015/09/25/gitlab-ce-in-docker/09.png&quot; alt=&quot;09.png&quot; title=&quot;&quot;&gt;
&lt;p&gt;等待一段時間後就成功就會顯示 Success：&lt;/p&gt;
&lt;img src=&quot;/2015/09/25/gitlab-ce-in-docker/10.png&quot; alt=&quot;10.png&quot; title=&quot;&quot;&gt;
&lt;p&gt;你也可以點進 build 中看執行的結果：&lt;/p&gt;
&lt;img src=&quot;/2015/09/25/gitlab-ce-in-docker/11.png&quot; alt=&quot;11.png&quot; title=&quot;&quot;&gt;
&lt;h3 id=&quot;Slack-Integration&quot;&gt;&lt;a href=&quot;#Slack-Integration&quot; class=&quot;headerlink&quot; title=&quot;Slack Integration&quot;&gt;&lt;/a&gt;Slack Integration&lt;/h3&gt;&lt;p&gt;Gitlab CI 也有提供 Slack 的整合，提供即時的 CI 狀態，只要填入 Webhook 即可：&lt;/p&gt;
&lt;img src=&quot;/2015/09/25/gitlab-ce-in-docker/12.png&quot; alt=&quot;12.png&quot; title=&quot;&quot;&gt;
&lt;h2 id=&quot;總結&quot;&gt;&lt;a href=&quot;#總結&quot; class=&quot;headerlink&quot; title=&quot;總結&quot;&gt;&lt;/a&gt;總結&lt;/h2&gt;&lt;p&gt;搞了三天左右都在學 Docker 跟弄這些環境，在精疲力乏與中秋烤肉之際順便記錄一下過程。&lt;br&gt;文中一些細節可以在根據需求做修改，像是在 test 的 docker image 就可以把 &lt;code&gt;mocha&lt;/code&gt; 裝進去，不用在 project 中額外安裝。Gitlab 的 CI 雖然不像 Jenkins CI 那麼容易的客製化，但是基本的功能也能滿足一些需求。當然 Gitlab CI 的功能我可能也沒完全摸透，可能有更強大的功能也說不定。&lt;/p&gt;
&lt;p&gt;另外未來還會串上 CD，另外加開一台 staging 的 instance 來 deploy，之後若串起來有空再寫下一篇分享。&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;本文建議了解 unix-like 基礎指令及 Docker 基本操作者閱讀。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;這幾天在我們的 imaclab 試著建置 CI 環境，順便就學了 Docker，發現 Docker 這東西真的非常方便，直接把環境都放進 container 裡，也不怕把環境搞爛。對環境建置的苦手真的是一番福音，網路上也很多關於 Docker 的文章，在這邊也不贅述了。&lt;br&gt;原本在架設的時候想使用 Gitlab + Jenkins，不過因專案的需求沒有需要 Jenkins 這麼開放客製化的 CI 工具（其實是我覺得很囉唆一堆東西要設定），剛好 Gitlab 也有提供 CI，需求上也符合，所以就決定使用 Gitlab + Gitlab CI。&lt;/p&gt;
    
    </summary>
    
      <category term="tutorial" scheme="http://jigsawye.com/categories/tutorial/"/>
    
    
      <category term="docker" scheme="http://jigsawye.com/tags/docker/"/>
    
      <category term="source-control" scheme="http://jigsawye.com/tags/source-control/"/>
    
      <category term="continuous-integration" scheme="http://jigsawye.com/tags/continuous-integration/"/>
    
      <category term="devops" scheme="http://jigsawye.com/tags/devops/"/>
    
      <category term="nodejs" scheme="http://jigsawye.com/tags/nodejs/"/>
    
  </entry>
  
  <entry>
    <title>在 Laravel 使用 Route Model Binding</title>
    <link href="http://jigsawye.com/2015/07/23/use-route-model-binding-in-laravel/"/>
    <id>http://jigsawye.com/2015/07/23/use-route-model-binding-in-laravel/</id>
    <published>2015-07-23T08:56:49.000Z</published>
    <updated>2016-02-04T06:11:28.000Z</updated>
    
    <content type="html">&lt;blockquote&gt;
&lt;p&gt;本文適用於 Laravel 5.0 以上版本。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;什麼是-Route-Model-Binding？&quot;&gt;&lt;a href=&quot;#什麼是-Route-Model-Binding？&quot; class=&quot;headerlink&quot; title=&quot;什麼是 Route Model Binding？&quot;&gt;&lt;/a&gt;什麼是 Route Model Binding？&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;Laravel model binding provides a convenient way to inject class instances into your routes. For example, instead of injecting a user’s ID, you can inject the entire User class instance that matches the given ID.&lt;br&gt;(&lt;a href=&quot;http://laravel.com/docs/5.0/routing#route-model-binding&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://laravel.com/docs/5.0/routing#route-model-binding&lt;/a&gt;)&lt;/p&gt;
&lt;/blockquote&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;p&gt;中文版：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Laravel 模型綁定提供方便的方式將模型實例注入到你的路由中。例如，比起注入 User 的 ID ，你可以選擇注入符合給定 ID 的 User 類別實例。&lt;br&gt;(&lt;a href=&quot;http://laravel.tw/docs/5.0/routing#route-model-binding&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://laravel.tw/docs/5.0/routing#route-model-binding&lt;/a&gt;)&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;文字敘述不懂沒關係，更快的方式就是舉個例子，假設我們有一個 Resource Route 及對應的 Resource Controller：&lt;br&gt;&lt;figure class=&quot;highlight php&quot;&gt;&lt;figcaption&gt;&lt;span&gt;route.php&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;Route::resource(&lt;span class=&quot;string&quot;&gt;&#39;articles&#39;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&#39;ArticlesController&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight php&quot;&gt;&lt;figcaption&gt;&lt;span&gt;ArticlesController.php&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;ArticlesController&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;Controller&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// 省略七個標準 RESTful method&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;一般來說，在 &lt;code&gt;show&lt;/code&gt; method 裡我們通常會這樣實作：&lt;br&gt;&lt;figure class=&quot;highlight php&quot;&gt;&lt;figcaption&gt;&lt;span&gt;ArticlesController.php&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;($id)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    $article = Article::find($id);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; view(&lt;span class=&quot;string&quot;&gt;&#39;articles.show&#39;&lt;/span&gt;, compact(&lt;span class=&quot;string&quot;&gt;&#39;article&#39;&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;但是只要透過 Route Model Binding，我們的程式碼就可以改成這樣：&lt;br&gt;&lt;figure class=&quot;highlight php&quot;&gt;&lt;figcaption&gt;&lt;span&gt;ArticlesController.php&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Article $article)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; view(&lt;span class=&quot;string&quot;&gt;&#39;articles.show&#39;&lt;/span&gt;, compact(&lt;span class=&quot;string&quot;&gt;&#39;article&#39;&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;對於我這種超懶的開發者很受用，少寫一行算一行，幫助開發更快速。&lt;/p&gt;
&lt;h2 id=&quot;設定-Route-Model-Binding&quot;&gt;&lt;a href=&quot;#設定-Route-Model-Binding&quot; class=&quot;headerlink&quot; title=&quot;設定 Route Model Binding&quot;&gt;&lt;/a&gt;設定 Route Model Binding&lt;/h2&gt;&lt;h4 id=&quot;綁定-Model&quot;&gt;&lt;a href=&quot;#綁定-Model&quot; class=&quot;headerlink&quot; title=&quot;綁定 Model&quot;&gt;&lt;/a&gt;綁定 Model&lt;/h4&gt;&lt;p&gt;一般來說都會將綁定設定在 &lt;code&gt;RouteServiceProvider&lt;/code&gt; （App/Provider/RouteServiceProvider.php）中，在這裡我用上述的範例做綁定：&lt;br&gt;&lt;figure class=&quot;highlight php&quot;&gt;&lt;figcaption&gt;&lt;span&gt;RouteServiceProvider.php&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;boot&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Router $router)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;parent&lt;/span&gt;::boot($router);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    $router-&amp;gt;bind(&lt;span class=&quot;string&quot;&gt;&#39;articles&#39;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&#39;App\Article&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;接著在我們的 method 直接使用 type-hine 注入 Model，就可以直接存取 &lt;code&gt;$article&lt;/code&gt; 了：&lt;br&gt;&lt;figure class=&quot;highlight php&quot;&gt;&lt;figcaption&gt;&lt;span&gt;ArticleController.php&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Article $article)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; view(&lt;span class=&quot;string&quot;&gt;&#39;article.show&#39;&lt;/span&gt;, compact(&lt;span class=&quot;string&quot;&gt;&#39;article&#39;&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;也就是說，如果 Request 是 &lt;code&gt;/articles/7&lt;/code&gt;，那麼 &lt;code&gt;$article&lt;/code&gt; 就會是 &lt;code&gt;Article::findOrFail(7)&lt;/code&gt;，若該筆資料不存在則會拋出 404。&lt;/p&gt;
&lt;h2 id=&quot;綁定做了什麼？&quot;&gt;&lt;a href=&quot;#綁定做了什麼？&quot; class=&quot;headerlink&quot; title=&quot;綁定做了什麼？&quot;&gt;&lt;/a&gt;綁定做了什麼？&lt;/h2&gt;&lt;p&gt;那麼 &lt;code&gt;bind&lt;/code&gt; 做了什麼事呢？讓我們看一下 Route list：&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;+-----------+---------------------------+------------------+----------------------------+&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;| Method    | URI                       | Name             | Action                     |&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+-----------+---------------------------+------------------+----------------------------+&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;| GET|HEAD  | articles                  | articles.index   | ArticlesController@index   |&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;| GET|HEAD  | articles/create           | articles.create  | ArticlesController@create  |&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;| POST      | articles                  | articles.store   | ArticlesController@store   |&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;| GET|HEAD  | articles/&amp;#123;articles&amp;#125;       | articles.show    | ArticlesController@show    |&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;| GET|HEAD  | articles/&amp;#123;articles&amp;#125;/edit  | articles.edit    | ArticlesController@edit    |&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;| PUT       | articles/&amp;#123;articles&amp;#125;       | articles.update  | ArticlesController@update  |&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;| PATCH     | articles/&amp;#123;articles&amp;#125;       | articles         | ArticlesController@update  |&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;| DELETE    | articles/&amp;#123;articles&amp;#125;       | articles.destroy | ArticlesController@destroy |&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+-----------+---------------------------+------------------+----------------------------+&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;注意到有 &lt;code&gt;{articles}&lt;/code&gt; 的 Route，這邊的變數 &lt;code&gt;articles&lt;/code&gt; 也就是我們在 &lt;code&gt;bind()&lt;/code&gt;傳入的第一個參數，Route Model Binding 會自動在你綁定的 Model（第二個參數 &lt;code&gt;\App\Article&lt;/code&gt;） 搜尋（&lt;code&gt;findOrFail&lt;/code&gt;）主鍵為 &lt;code&gt;{articles}&lt;/code&gt; 的資料。所以不只在 &lt;code&gt;show&lt;/code&gt; method，只要任何有 &lt;code&gt;{articles}&lt;/code&gt; 的 Route 都會自動做綁定，相當的方便（懶人）。&lt;/p&gt;
&lt;h2 id=&quot;自定搜尋條件&quot;&gt;&lt;a href=&quot;#自定搜尋條件&quot; class=&quot;headerlink&quot; title=&quot;自定搜尋條件&quot;&gt;&lt;/a&gt;自定搜尋條件&lt;/h2&gt;&lt;p&gt;有些情況並不適用於預設的 &lt;code&gt;Model::findOrFail($id)&lt;/code&gt;，例如只希望找出已經發佈的 Article，這時候可以改變 &lt;code&gt;bind()&lt;/code&gt; 的第二個參數為包含自訂搜尋的條件的 Closure：&lt;br&gt;&lt;figure class=&quot;highlight php&quot;&gt;&lt;figcaption&gt;&lt;span&gt;RouteServiceProvider.php&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;boot&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Router $router)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;parent&lt;/span&gt;::boot($router);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    $router-&amp;gt;bind(&lt;span class=&quot;string&quot;&gt;&#39;articles&#39;&lt;/span&gt;, &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;params&quot;&gt;($id)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; \App\Article::where(&lt;span class=&quot;string&quot;&gt;&#39;published_at&#39;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&#39;&amp;lt;=&#39;&lt;/span&gt;, Carbon::now())-&amp;gt;findOrFail($id);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;到此你已經瞭解如何運用 Route Model Binding 囉！未來如果搭上 Form Model binding 在開發上會更加的快速（懶人）！&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;本文適用於 Laravel 5.0 以上版本。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;什麼是-Route-Model-Binding？&quot;&gt;&lt;a href=&quot;#什麼是-Route-Model-Binding？&quot; class=&quot;headerlink&quot; title=&quot;什麼是 Route Model Binding？&quot;&gt;&lt;/a&gt;什麼是 Route Model Binding？&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;Laravel model binding provides a convenient way to inject class instances into your routes. For example, instead of injecting a user’s ID, you can inject the entire User class instance that matches the given ID.&lt;br&gt;(&lt;a href=&quot;http://laravel.com/docs/5.0/routing#route-model-binding&quot;&gt;http://laravel.com/docs/5.0/routing#route-model-binding&lt;/a&gt;)&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="tutorial" scheme="http://jigsawye.com/categories/tutorial/"/>
    
    
      <category term="laravel" scheme="http://jigsawye.com/tags/laravel/"/>
    
      <category term="laravel5" scheme="http://jigsawye.com/tags/laravel5/"/>
    
      <category term="route-model-binding" scheme="http://jigsawye.com/tags/route-model-binding/"/>
    
  </entry>
  
  <entry>
    <title>在 Laravel 5 使用 PJAX 加快網頁載入速度</title>
    <link href="http://jigsawye.com/2015/06/22/using-pjax-with-laravel-5/"/>
    <id>http://jigsawye.com/2015/06/22/using-pjax-with-laravel-5/</id>
    <published>2015-06-22T03:50:48.000Z</published>
    <updated>2016-02-04T06:12:39.000Z</updated>
    
    <content type="html">&lt;blockquote&gt;
&lt;p&gt;本文適用於 Laravel 5.0 以上版本。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;什麼是-PJAX-？&quot;&gt;&lt;a href=&quot;#什麼是-PJAX-？&quot; class=&quot;headerlink&quot; title=&quot;什麼是 PJAX ？&quot;&gt;&lt;/a&gt;什麼是 PJAX ？&lt;/h2&gt;&lt;p&gt;簡單來說，以往使用的 &lt;code&gt;AJAX&lt;/code&gt; 可以不重新載入網頁，異步載入伺服器的資料，並更新畫面。而 &lt;code&gt;PJAX&lt;/code&gt; 則是加入了 HTML5 的 &lt;code&gt;PushState&lt;/code&gt; 技術，在取得資料的同時改變 Url，可以保留瀏覽器上一頁的功能，而且不會從伺服器重新載入 js 及 css 之類的靜態檔案，加快網頁的載入速度。&lt;br&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;開始上手&quot;&gt;&lt;a href=&quot;#開始上手&quot; class=&quot;headerlink&quot; title=&quot;開始上手&quot;&gt;&lt;/a&gt;開始上手&lt;/h2&gt;&lt;h4 id=&quot;伺服器端安裝-jacobbennett-pjax&quot;&gt;&lt;a href=&quot;#伺服器端安裝-jacobbennett-pjax&quot; class=&quot;headerlink&quot; title=&quot;伺服器端安裝 jacobbennett/pjax&quot;&gt;&lt;/a&gt;伺服器端安裝 &lt;code&gt;jacobbennett/pjax&lt;/code&gt;&lt;/h4&gt;&lt;p&gt;在 Laravel 我們需要安裝 &lt;code&gt;jacobbennett/pjax&lt;/code&gt; 這隻 Package（&lt;a href=&quot;https://github.com/JacobBennett/pjax&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Github&lt;/a&gt;），他會根據 Request 是否為 PJAX 來回傳對應資料。安裝請直接修改 &lt;code&gt;composer.json&lt;/code&gt;：&lt;br&gt;&lt;figure class=&quot;highlight js&quot;&gt;&lt;figcaption&gt;&lt;span&gt;composer.json&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;...&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;&quot;require&quot;&lt;/span&gt;: &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    ...&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;&quot;jacobbennett/pjax&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;0.*&quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;...&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;接著執行 &lt;code&gt;composer update&lt;/code&gt; 或是 &lt;code&gt;composer install&lt;/code&gt; 安裝 package。&lt;/p&gt;
&lt;p&gt;安裝完成後，我們要把 &lt;code&gt;jacobbennett/pjax&lt;/code&gt; 的 middleware 加到我們預設的 middleware 中，打開 &lt;code&gt;app/Http/Kernel.php&lt;/code&gt;，在 &lt;code&gt;$middleware&lt;/code&gt; 增加：&lt;br&gt;&lt;figure class=&quot;highlight php&quot;&gt;&lt;figcaption&gt;&lt;span&gt;app/Http/Kernel.php&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;...&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;protected&lt;/span&gt; $middleware = [&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    ...&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;&#39;JacobBennett\Pjax\PjaxMiddleware&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;...&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;這樣 Laravel 的部分就準備完成了。&lt;/p&gt;
&lt;h4 id=&quot;前端安裝-jQuery-pjax&quot;&gt;&lt;a href=&quot;#前端安裝-jQuery-pjax&quot; class=&quot;headerlink&quot; title=&quot;前端安裝 jQuery.pjax&quot;&gt;&lt;/a&gt;前端安裝 &lt;code&gt;jQuery.pjax&lt;/code&gt;&lt;/h4&gt;&lt;p&gt;前端部分使用 &lt;code&gt;jQuery.pjax&lt;/code&gt; 這隻 Library，&lt;code&gt;jQuery.pjax&lt;/code&gt; 是基於 jQuery，並封裝了 pushState 與 AJAX ，讓你更容易使用 PJAX 的 Library，關於此 Library 可以參閱 &lt;a href=&quot;https://github.com/defunkt/jquery-pjax&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;jQuery.pjax 的 Github&lt;/a&gt;。另外 &lt;code&gt;jQuery.pjax&lt;/code&gt; 依賴於 &lt;code&gt;jQuery 1.8.x&lt;/code&gt; 以上，所以安裝前請確保你的專案有載入 &lt;code&gt;jQuery&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;下載 &lt;code&gt;jquery.pjax.js&lt;/code&gt; 至你的專案中，本範例下載至專案的 &lt;code&gt;/public/javascripts&lt;/code&gt; 資料夾，我習慣使用 &lt;code&gt;wget&lt;/code&gt;，你可以使用你習慣的方式下載，像是 &lt;code&gt;curl&lt;/code&gt; 或是直接用瀏覽器：&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ wget -P public/javascripts https://raw.github.com/defunkt/jquery-pjax/master/jquery.pjax.js&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;接著在你的 &lt;code&gt;views&lt;/code&gt; 中載入檔案：&lt;br&gt;&lt;figure class=&quot;highlight xml&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;script&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;src&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;&amp;#123;&amp;#123; assets(&#39;javascripts/jquery.pjax.js&#39;) &amp;#125;&amp;#125;&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;undefined&quot;&gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;最後增加 JavaScript：&lt;br&gt;&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$(&lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;).ready(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    $(&lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;).pjax(&lt;span class=&quot;string&quot;&gt;&#39;a&#39;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&#39;body&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;上方程式的第一個參數代表會攔截所有的 &lt;code&gt;a&lt;/code&gt; 標籤，若瀏覽器有支援就改以 PJAX 的方式送出，第二個參數代表接收到的資料替換至 &lt;code&gt;body&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;另外，PushState 有瀏覽器支援的問題（萬惡的 IE），支援度可以至 &lt;a href=&quot;http://caniuse.com/#search=pushstate&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Can I use&lt;/a&gt; 查看，不過這不用擔心，若瀏覽器不支援 PushState，就會以原始方式打開超連結。&lt;/p&gt;
&lt;h4 id=&quot;完成！&quot;&gt;&lt;a href=&quot;#完成！&quot; class=&quot;headerlink&quot; title=&quot;完成！&quot;&gt;&lt;/a&gt;完成！&lt;/h4&gt;&lt;p&gt;完成上面的步驟後你的專案就擁有 PJAX 的功能了，打開 Devtools 的 Network 畫面，點擊任一 &lt;code&gt;a&lt;/code&gt; 標籤，就會看到帶有 &lt;code&gt;_pjax=body&lt;/code&gt; 的 Request ，接著畫面就會更新了！&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://i.imgur.com/xrKP9S0.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;加上載入動畫&quot;&gt;&lt;a href=&quot;#加上載入動畫&quot; class=&quot;headerlink&quot; title=&quot;加上載入動畫&quot;&gt;&lt;/a&gt;加上載入動畫&lt;/h2&gt;&lt;p&gt;不過這樣的 UX 不是很好，有時點擊連結後有某些原因造成等待的時間較久，使用者可能覺得沒反應就會重新載入，或是重複點擊，這樣的效果並不好，所以我們要加上載入動畫，實作效果可以參考 Youtube（下圖畫面上方的紅色讀取條）。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://i.imgur.com/rXvQMSS.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;h4 id=&quot;安裝-nprogress-js&quot;&gt;&lt;a href=&quot;#安裝-nprogress-js&quot; class=&quot;headerlink&quot; title=&quot;安裝 nprogress.js&quot;&gt;&lt;/a&gt;安裝 nprogress.js&lt;/h4&gt;&lt;p&gt;&lt;code&gt;nprogress.js&lt;/code&gt; 是一個載入動畫的 Library，效果可以參考&lt;a href=&quot;http://ricostacruz.com/nprogress/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;它的官方網站&lt;/a&gt;，也可在&lt;a href=&quot;https://github.com/rstacruz/nprogress&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;它的 Github&lt;/a&gt; 參考使用的 API。&lt;/p&gt;
&lt;p&gt;下載檔案至專案中：&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ wget -P public/javascripts http://ricostacruz.com/nprogress/nprogress.js&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ wget -P public/stylesheets http://ricostacruz.com/nprogress/nprogress.css&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;接著在 &lt;code&gt;views&lt;/code&gt; 載入檔案：&lt;br&gt;&lt;figure class=&quot;highlight xml&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;link&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;rel&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;stylesheet&quot;&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;href&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;&amp;#123;&amp;#123; asset(&#39;stylesheets/nprogress.css&#39;) &amp;#125;&amp;#125;&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;script&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;src&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;&amp;#123;&amp;#123; assets(&#39;javascripts/nprogress.js&#39;) &amp;#125;&amp;#125;&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;undefined&quot;&gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;最後把效果加到 PJAX 的生命週期中：&lt;br&gt;&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$(&lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;).ready(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    $(&lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;).pjax(&lt;span class=&quot;string&quot;&gt;&#39;a&#39;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&#39;body&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    $(&lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;).on(&lt;span class=&quot;string&quot;&gt;&#39;pjax:start&#39;&lt;/span&gt;, &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        NProgress.start();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    $(&lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;).on(&lt;span class=&quot;string&quot;&gt;&#39;pjax:end&#39;&lt;/span&gt;, &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        NProgress.done();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h4 id=&quot;噹啷！完成！&quot;&gt;&lt;a href=&quot;#噹啷！完成！&quot; class=&quot;headerlink&quot; title=&quot;噹啷！完成！&quot;&gt;&lt;/a&gt;噹啷！完成！&lt;/h4&gt;&lt;p&gt;至此你的專案已經擁有完整的 PJAX 了！&lt;/p&gt;
&lt;h2 id=&quot;Q-amp-A：&quot;&gt;&lt;a href=&quot;#Q-amp-A：&quot; class=&quot;headerlink&quot; title=&quot;Q &amp;amp; A：&quot;&gt;&lt;/a&gt;Q &amp;amp; A：&lt;/h2&gt;&lt;p&gt;Q：我不喜歡 nprogress 的效果，有沒有別的可以用？&lt;br&gt;A：你可以考慮使用 &lt;a href=&quot;http://github.hubspot.com/pace/docs/welcome/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;PACE&lt;/a&gt;、&lt;a href=&quot;http://usablica.github.io/progress.js/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Progress.js&lt;/a&gt;，不過我都沒使用過，但方式應該是大同小異。&lt;/p&gt;
&lt;p&gt;Q：為什麼我的一些 JavaScript Library 會爆掉沒反應？&lt;br&gt;A：你使用的 Library 如果需要在畫面載入完時重新初始化（像是 &lt;a href=&quot;http://portfoliojs.com/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;portfolio.js&lt;/a&gt;），請把相關程式碼放入 &lt;code&gt;PJAX&lt;/code&gt; 的生命週期中，如下：&lt;br&gt;&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$(&lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;).on(&lt;span class=&quot;string&quot;&gt;&#39;pjax:end&#39;&lt;/span&gt;, &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    initPortfolio();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    NProgress.done();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;有其他問題也可以留言，我會盡力幫助你的 :)&lt;/p&gt;
&lt;p&gt;References: &lt;a href=&quot;https://phphub.org/topics/44&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;PHPHub&lt;/a&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;本文適用於 Laravel 5.0 以上版本。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;什麼是-PJAX-？&quot;&gt;&lt;a href=&quot;#什麼是-PJAX-？&quot; class=&quot;headerlink&quot; title=&quot;什麼是 PJAX ？&quot;&gt;&lt;/a&gt;什麼是 PJAX ？&lt;/h2&gt;&lt;p&gt;簡單來說，以往使用的 &lt;code&gt;AJAX&lt;/code&gt; 可以不重新載入網頁，異步載入伺服器的資料，並更新畫面。而 &lt;code&gt;PJAX&lt;/code&gt; 則是加入了 HTML5 的 &lt;code&gt;PushState&lt;/code&gt; 技術，在取得資料的同時改變 Url，可以保留瀏覽器上一頁的功能，而且不會從伺服器重新載入 js 及 css 之類的靜態檔案，加快網頁的載入速度。&lt;br&gt;
    
    </summary>
    
      <category term="tutorial" scheme="http://jigsawye.com/categories/tutorial/"/>
    
    
      <category term="laravel" scheme="http://jigsawye.com/tags/laravel/"/>
    
      <category term="laravel5" scheme="http://jigsawye.com/tags/laravel5/"/>
    
      <category term="pjax" scheme="http://jigsawye.com/tags/pjax/"/>
    
  </entry>
  
</feed>
